haplotypeColorFxn = function( feature, variableName, glyphObject, trackObject ) {
  return haplotypeColor(feature);
 }
snpColorFxn = function( feature, variableName, glyphObject, trackObject ) {
  return snpBgFromIsCodingAndNonSyn(feature);
 }
colorSpliceSiteFxn = function(feature, variableName, glyphObject, trackObject) {
  return colorSpliceSite(feature);
 }
chipColorFxn = function( feature, variableName, glyphObject, trackObject ) {
  return chipColor(feature, variableName, glyphObject, trackObject);
 }
colorSegmentByScoreFxn = function( feature, variableName, glyphObject, trackObject ) {
  return colorSegmentByScore(feature, variableName, glyphObject, trackObject);
 }
massSpecColor = function( feature, variableName, glyphObject, trackObject ) {
  var color = feature.data["Color"];
  if(!color) {
    color = feature.parent().data["Color"];
  }  
  if(color) {
    var colors = color.split(';');
    return colors[0];
  }
  return 'yellow';
 }
massSpecLabel = function(track, feature, featureDiv) {
  return(feature.data["Sample"]);
 }
processedTranscriptColor = function( featureObject, variableName, glyphObject, trackObject ) {
   return(featureObject.data["strand"] == 1 ? "#000080" : "#aa3311" )
 }
alternateTranscriptColor = function( featureObject, variableName, glyphObject, trackObject ) {
   return(featureObject.data["strand"] == 1 ? "dodgerblue" : "hotpink" )
 }
nrdbColor = function( featureObject, variableName, glyphObject, trackObject ) {
   return(featureObject.data["strand"] == 1 ? "mediumblue" :  "crimson")
 }
orfColor = function( featureObject, variableName, glyphObject, trackObject ) {
   return(featureObject.data["strand"] == 1 ? "dodgerblue" :  "mediumvioletred")
 }
piggyBacColor = function( featureObject, variableName, glyphObject, trackObject ) {
   return(featureObject.data["strand"] == 1 ? "dodgerblue" :  "mediumvioletred")
 }
estColor = function( featureObject, variableName, glyphObject, trackObject ) {
   return(featureObject.data["strand"] == 1 ? "deepskyblue" :  "pink")
 }
estBorderColor = function( featureObject, variableName, glyphObject, trackObject ) {
   return(featureObject.data["strand"] == 1 ? "darkslateblue" :  "deeppink")
 }
popsetColor = function( featureObject, variableName, glyphObject, trackObject ) {
   return(featureObject.data["strand"] == 1 ? "lightblue" :  "red")
 }
orfDetails = function(track, feature, featureDiv) {
    var rows = new Array();
    rows.push(twoColRow('Name:', feature.data["name"]));
    rows.push(twoColRow('Position:', positionString(track.refSeq.name, feature.data["startm"], feature.data["end"], feature.data["strand"])));
    rows.push(twoColRow('Length:', feature.data["Length"] + "aa"));
    return table(rows);
 }
piggyBacTitle = function(track, feature, featureDiv) {
    var rows = new Array();
    rows.push(twoColRow('Position:', positionString(track.refSeq.name, feature.data["startm"], feature.data["end"], feature.data["strand"])));
    return table(rows);
 }
popsetDetails = function(track, feature, featureDiv) {
    var rows = new Array();
    rows.push(twoColRow('Name:', feature.data["name"]));
    rows.push(twoColRow('Score:', feature.data["score"]));
    rows.push(twoColRow('Expect:', feature.data["Expect"]));
    rows.push(twoColRow('Match:', feature.data["MatchLen"] + " nt"));
    rows.push(twoColRow('Note:', feature.data["Note"]));
    return table(rows);
 }
estDetails = function(track, feature, featureDiv) {
    var rows = new Array();
    var name  = feature.data["name"]; 
    var start = feature.data["startm"];
    var end = feature.data["end"];
    var strand = feature.data["strand"];
    var score = feature.data["score"];
    var percent_identity = feature.data["PercentIdentity"];
    var primer = feature.data["Primer"];
    var library = feature.data["Library"];
    var vector = feature.data["Vector"];
    var stage = feature.data["Stage"];
    rows.push(twoColRow('Name:', name));
    rows.push(twoColRow('Position:', positionString(track.refSeq.name, start, end, strand)));
    rows.push(twoColRow('Percent Identity:', percent_identity));
    rows.push(twoColRow('Length:', Math.abs(end-start) + " nt"));
    rows.push(twoColRow('Score:', score));
    rows.push(twoColRow('Library:', library));
    if(vector) rows.push(twoColRow('Vector:', vector));
    if(primer) rows.push(twoColRow('Primer:', primer));
    if(stage) rows.push(twoColRow('Stage:', stage));
    return table(rows);
 }
nrdbDetails = function(track, feature, featureDiv) {
    var rows = new Array();
    var name = feature.data["name"];
    var score = feature.data["score"];
    var pctI = feature.data["PercentIdentity"];
    var desc = feature.data["Defline"];
    desc.replace("\001", "");
    rows.push(twoColRow('GI number:', name));
    rows.push(twoColRow('Score:', score));
    rows.push(twoColRow('Position:', positionString(track.refSeq.name, feature.data["startm"], feature.data["end"], feature.data["strand"])));
    rows.push(twoColRow('Identity:', round(pctI, 1)));
    if(desc) rows.push(twoColRow('Description:', desc));
    return table(rows);
 }
processedTranscriptDetails = function(track, feature, featureDiv) {
    var projectId = feature.data["ProjectId"];                           
    var sourceId = feature.data["name"];
    var chr = track.refSeq.name;
    var strand = feature.data["strand"];
    var model = orientAndGetUtrsAndCDS(strand,feature.data["subfeatures"]);
    var gene_id = feature.data["geneId"];
    var soTerm = feature.data["soTerm"];
    var isPseudo = feature.data["isPseudo"];
    var aaSeqId = feature.data["aaSeqId"];
    var orthomclName = feature.data["orthomcl_name"];
    if(orthomclName === sourceId) orthomclName = "";
    soTerm = soTerm.replace(/_/g, " ");
    soTerm = titleCase(soTerm);
    if(isPseudo === 1) soTerm = soTerm + " (pseudogene)";
    var product = feature.data["product"] ? feature.data["product"] : feature.data["description"];
    var taxon = feature.data["taxon"];
    var window = 500;
    var linkStart = feature.data["startm"] - window;
    var linkStop = feature.data["end"] + window;
    var seqId = feature.data["Contig"];
    var loc = seqId + ":" + linkStart + ".." + linkStop;
    var baseRecordUrl = "/a/app/record";
    var dataRoot = track.browser.config.dataRoot;
    var baseUrl = track.browser.config.baseUrl;
    return gene_title(this, projectId, sourceId, chr, model[1], soTerm, product, taxon, model[0], model[2], loc, orthomclName, gene_id, dataRoot, baseUrl, baseRecordUrl, aaSeqId);
 }
massSpecDetails = function(track, feature, featureDiv) {
  var rows = new Array();
  var count = feature.data["Count"];
  var seq =  feature.data["PepSeq"];
  var extdbname = feature.data["ExtDbName"];
  var experiment = feature.data["Experiment"];
  var sample = feature.data["Sample"];
  var phospho_site = feature.data["ModSite"];
  var ontology_names = feature.data["Ontology"];
  var tb = "<table><tr><th>Location</th><th>Modified Residue</th><th>Modification Type</th></tr>";
  var start = feature.data["startm"];
  if(phospho_site && phospho_site != 'NA') {
    var residue = feature.data["Residue"];
    var locs =  phospho_site.split(';');
    var term = ontology_names.split(';');
    var residues = residue.split(';');
    for (i = 0; i < locs.length; i++) { 
       tb = tb + "<tr><td>" + locs[i] + "</td><td>" + residues[i] + "</td><td>" + term[i] + "</td></tr>";
    }
  tb = tb + "</table>"; 
  }
  rows.push(twoColRow('Experiment:', experiment));
  rows.push(twoColRow('Sample:', sample));
  rows.push(twoColRow('Sequence:', seq));
  rows.push(twoColRow('Spectrum Count:', count));
  return table(rows);
 }
gsnapUnifiedIntronJunctionTitleFxn = function(track, feature, featureDiv) {
  return gsnapUnifiedIntronJunctionTitle(track, feature, featureDiv);
 }
gsnapUnifiedIntronJunctionHooksModify = function(track, feature, div) {
   var height = gsnapIntronHeightFromPercent(feature);
   var postHeight = gsnapIntronWidthFromScore(feature);
   var color = gsnapIntronColorFromStrandAndScore(feature);
   div.style.height = height + "px";
   div.style.borderRightColor = color;
   div.style.borderLeftColor = color;
   div.style.backgroundColor = color;
   div.style.borderTopWidth = postHeight + "px";
   div.style.borderBottomWidth = postHeight + "px";
   div.style.boxSizing = "border-box"; /** thanks Dave! without this the right edge of the glyph extends too far **/
   track.config.style.showLabels = false;
   track.showLabels = false;
 }
peakTitleChipSeqFxn = function(track, feature, featureDiv) {
  return peakTitleChipSeq(track, feature, featureDiv);
 }
tandemRepeatDetailsFxn = function(track, feature, featureDiv) {
  return positionAndSequence(track, feature, featureDiv);
 }
positionAndSequenceFxn = function(track, feature, featureDiv) {
  return positionAndSequence(track, feature, featureDiv);
 }
lowComplexityDetailsFxn = function(track, feature, featureDiv) {
  return positionAndSequence(track, feature, featureDiv);
 }
snpTitleFxn = function(track, feature, featureDiv) {
  return snpTitle(track, feature, featureDiv);
 }
spliceSiteTitleFxn = function(track, feature, featureDiv) {
  return spliceSiteTitle(track, feature, featureDiv);
 }
gffKirklandFxn = function(track, feature, featureDiv) {
  return gffKirkland(track, feature, featureDiv)
 }
repeatFamilyFxn = function(track, feature, featureDiv) {
  return repeatFamily(track, feature, featureDiv)
 }
transposonFxn = function(track, feature, featureDiv) {
  return transposon(track, feature, featureDiv)
 }
bindingSitesFxn = function(track, feature, featureDiv) {
  return bindingSiteTitle(track, feature, featureDiv)
 }
colorForBindingSitesByPvalueFxn = function(feature) {
  return colorForBindingSitesByPvalue(feature)
 }
gffGeneFeatureTitleFxn = function(track, feature) {
  return gffGeneFeatureTitle(track,feature)
 }
microsatelliteTitleFxn = function(track, feature, featDiv) {
  return microsatelliteTitle(track, feature, featDiv);
 }
haplotypeTitleFxn = function(track, feature, featDiv) {
  return haplotypeTitle(track, feature, featDiv);
 }

