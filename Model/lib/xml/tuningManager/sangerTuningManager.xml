<?xml version="1.0" encoding="UTF-8"?>
<tuningConfig>

  <tuningTable name="OldAnnotationChange" alwaysUpdate="true">
    <ancillaryTable name="OldReviewedComment"/>
    <program commandLine="buildOldAnnotationChangeTT"/>
  </tuningTable>

  <tuningTable name="OldChangedGeneProduct" alwaysUpdate="true">
    <internalDependency name="OldAnnotationChange"/>
    <sql>
      <![CDATA[
        create table OldChangedGeneProduct&1 nologging as
        select distinct *
        from (select ga.source_id as gene, 
                     case when ga.product != ac.product then ac.product else null end as product,
                     case when ga.name != ac.name then ac.name else null end as name
              from apidbTuning.GeneAttributes ga,
                   (select gene,
                           max(product) keep (dense_rank last order by change_date) as product,
                           max(name) keep (dense_rank last order by change_date) as name
                    from OldAnnotationChange ac
                    where gene is not null
                    group by gene) ac
              where ac.gene = ga.source_id)
        where product is not null or name is not null
      ]]>
    </sql>
    <sql>
      <![CDATA[
        create unique index cgp_ix&1 on OldChangedGeneProduct&1 (gene)
      ]]>
    </sql>
  </tuningTable>

  <tuningTable name="OldPlasmogem" alwaysUpdate="true">
    <program commandLine="buildOldPlasmogemTT"/>
  </tuningTable>

</tuningConfig>
