<wdkModel>


  <!--===========================================================================-->
  <!-- Metrics   questions -->
  <!--  * scripts in https://github.com/VEuPathDB/MetricsReports/tree/main/usage/bin    -->
  <!--  * each script generates content for one or two tables in the database   -->
  <!--  * we start by making a question per database table -->
  <!--===========================================================================-->

  <questionSet name="MetricsQuestions" displayName="Search for Metrics">


    <!-- ************************************************************ -->
    <!-- Awstats                            -->
    <!-- ************************************************************ -->
    <question name="Awstats"
      displayName="Awstats"
      shortDisplayName="Awstats"
      queryRef="MetricsId.Awstats"
      recordClassRef="MetricsRecordClasses.MetricsRecordClass"  >

      <attributesList
        summary="project_id,start_date,unique_visitors,visits,page_data_requests,avg_visit_duration,bandwidth_gb"
        sorting="page_data_requests desc"
      />

      <summary>
        Report on awstats.
      </summary>

      <description>
        Report on awstats.

      </description>

      <dynamicAttributes>

        <columnAttribute name="project_id" displayName="Project collected" align="center" 
                         help="Stats collected in this project/website; if 'Unknown' it could be any number of websites,  
                               a subset of requests within the time period requested">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>


        <columnAttribute name="unique_visitors" displayName="# Unique visitors" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="visits" displayName="# Visits" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="page_data_requests" displayName="# Page data requests" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="avg_visit_duration" displayName="Average visit duration" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="bandwidth_gb" displayName="Bandwidth (GB)" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="start_date" displayName="Month"/>
        <columnAttribute name="end_date" displayName="End date"/>

      </dynamicAttributes>

    </question>

    <!-- ************************************************************ -->
    <!--  Login Stats       -->
    <!-- ************************************************************ -->
    <question name="LoginStats"
      displayName="Loginstats"
      shortDisplayName="LoginStats"
      queryRef="MetricsId.LoginStats"
      recordClassRef="MetricsRecordClasses.MetricsRecordClass"  >

      <attributesList
        summary="project_id,start_date,unique_logins,newly_registered,total_registered"
        sorting="newly_registered desc"
      />

      <summary>
        Report on how many users logged in, and how many registered.
      </summary>

      <description>
        Report on how many users logged in. If a user loggs in twice, we only count once. Regular users should stay logged in month to month. They might get occasionally forced to login more than once when we restart oauth or expire bearer tokens. 

      </description>

      <dynamicAttributes>

        <columnAttribute name="project_id" displayName="Project collected" align="center"
                         help="Stats collected in this project/website; if 'Unknown' it could be any number of websites,  
                               a subset of requests within the time period requested">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="unique_logins" displayName="# Unique logins" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="newly_registered" displayName="# Newly registered users" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="total_registered" displayName="# Total registered users" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="start_date" displayName="Month"/>
        <columnAttribute name="end_date" displayName="End date"/>

      </dynamicAttributes>

    </question>

    <!-- ************************************************************ -->
    <!-- PageViewStats                            -->
    <!-- ************************************************************ -->
    <question name="PageViewStats"
      displayName="Page View Stats"
      shortDisplayName="PageViewStats"
      queryRef="MetricsId.PageViewStats"
      recordClassRef="MetricsRecordClasses.MetricsRecordClass"  >

      <attributesList
        summary="project_id,start_date,registered_users_count,registered_page_count,guest_users_count,guest_page_count"
        sorting="registered_page_count desc"
      />

      <summary>
        Report on Page View stats
      </summary>

      <description>
        Report on Page View stats

      </description>

      <dynamicAttributes>

        <columnAttribute name="project_id" displayName="Project collected" align="center"
                         help="Stats collected in this project/website; if 'Unknown' it could be any number of websites,  
                               a subset of requests within the time period requested">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="registered_users_count" displayName="# Registered users who used a site" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="registered_page_count" displayName="# Page views from registered users" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="guest_users_count" displayName="# Guest users who used a site" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="guest_page_count" displayName="# Page views from guest users" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="start_date" displayName="Month"/>
        <columnAttribute name="end_date" displayName="End date"/>

      </dynamicAttributes>

    </question>


    <!-- ************************************************************ -->
    <!-- Record page view stats                            -->
    <!-- ************************************************************ -->
    <question name="RecordPageViewStats"
      displayName="Record Page View Stats"
      shortDisplayName="RecordPageViewStats"
      queryRef="MetricsId.RecordPageViewStats"
      recordClassRef="MetricsRecordClasses.MetricsRecordClass"  >

      <attributesList
        summary="project_id,start_date,url_segment,count"
        sorting="count desc"
      />

      <summary>
        Report on Record pages from access logs.
      </summary>

      <description>
        Report on record pages from access logs.

      </description>

      <dynamicAttributes>

        <columnAttribute name="project_id" displayName="Project collected" align="center"
                         help="Stats collected in this project/website; if 'Unknown' it could be any number of websites,  
                               a subset of requests within the time period requested">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="url_segment" displayName="Data type" align="center">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="count" displayName="# Record page views" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="start_date" displayName="Month"/>
        <columnAttribute name="end_date" displayName="End date"/>

      </dynamicAttributes>

    </question>


    <!-- ************************************************************ -->
    <!-- User Datasets                            -->
    <!-- ************************************************************ -->
    <question name="UserDatasets"
      displayName="User Datasets"
      shortDisplayName="UserDatasets"
      queryRef="MetricsId.UserDatasets"
      recordClassRef="MetricsRecordClasses.MetricsRecordClass"  >

      <attributesList
        summary="project_id,start_date,dataset_type,new_complete,new_incomplete,total_complete,total_incomplete"
        sorting="new_complete desc"
      />

      <summary>
        Report on user datasets
      </summary>

      <description>
        Report on user datasets

      </description>

      <dynamicAttributes>

        <columnAttribute name="project_id" displayName="Project collected" align="center"
                         help="Stats collected in this project/website; if 'Unknown' it could be any number of websites,  
                               a subset of requests within the time period requested">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="dataset_type" displayName="Dataset type" align="center">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="total_complete" displayName="# Total installed" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="new_complete" displayName="# Newly installed" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="total_incomplete" displayName="# Total incomplete" align="center"
                         help="A user dataset might not get fully installed for various reasons: failed import, failed metadata install or failed data install.">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="new_incomplete" displayName="# Newly incomplete" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="start_date" displayName="Month"/>
        <columnAttribute name="end_date" displayName="End date"/>

      </dynamicAttributes>

    </question>


    <!-- ************************************************************ -->
    <!-- Organism-related page views  stats                             -->
    <!-- ************************************************************ -->
    <question name="OrgPageViewMetrics"
      displayName="Organism-related Page views"
      shortDisplayName="Page views per Organism"
      queryRef="MetricsId.OrgPageViewMetrics"
      recordClassRef="MetricsRecordClasses.MetricsRecordClass"  >

      <attributesList
        summary="project_id,start_date,organism,is_reference,count,org_project"
        sorting="count desc"
      />

      <summary>
        Usage of record page views, per organism.
      </summary>

      <description>
        Count record page views per organism.  The record pages included are: genes, genomic sequences, snps and organism-specific datasets.

	Under the hood, each time the user visits a record page associated with an organism, the web client makes a request to a dedicated "organism view" endpoint. These are tracked by prometheus, which is queried to produce this metric.

      </description>

      <dynamicAttributes>

        <columnAttribute name="project_id" displayName="Project collected" align="center"
                         help="Stats collected in this project/website; if 'Unknown' it could be any number of websites,  
                               a subset of requests within the time period requested">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="organism" displayName="Organism" align="center">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="org_project" displayName="Organism website" align="center">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="is_reference" displayName="Is reference?" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="count" displayName="# Record page views" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="start_date" displayName="Month">
                    <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="end_date" displayName="End date"/>

      </dynamicAttributes>

    </question>



    <!-- ************************************************************ -->
    <!--  Organism param stats  (1 script generates content for 2 tables) -->
    <!--    OrgParamCountMetrics:    projectId |  organismValueCount |  stepCount  -->
    <!--    OrgParamNameMetrics:    projectId |  organismName |  stepCount  -->
    <!-- ************************************************************ -->

    <question name="OrgParamCountMetrics"
      displayName="Number of organisms selected per search"
      shortDisplayName="Organism count per search"
      queryRef="MetricsId.OrgParamCountMetrics"
      recordClassRef="MetricsRecordClasses.MetricsRecordClass"  >

      <attributesList
        summary="project_id,start_date,number_of_organisms,steps_count"
        sorting="steps_count desc"
      />

      <summary>
        Report the number of searches that were paramterized by a particular number of organisms.
      </summary>

      <description>
	For each observed number of organisms used as parameters to a WDK search, report how many searches used that number of organisms.

	This data is acquired from the organism parameter in steps stored in the user database.
      </description>

      <dynamicAttributes>

        <columnAttribute name="project_id" displayName="Project collected" align="center"
                         help="Stats collected in this project/website; if 'Unknown' it could be any number of websites,  
                               a subset of requests within the time period requested">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="number_of_organisms" displayName="# Organisms" align="center" help="Number of organisms selected for the search">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="steps_count" displayName="# Searches" align="center" help="Number of searches having a particular number of organisms selected">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="start_date" displayName="Month"/>
        <columnAttribute name="end_date" displayName="End date"/>

      </dynamicAttributes>

    </question>


    <question name="OrgParamNameMetrics"
      displayName="Number of Searches per Organism"
      shortDisplayName="Search count per Organism"
      queryRef="MetricsId.OrgParamNameMetrics"
      recordClassRef="MetricsRecordClasses.MetricsRecordClass"  >

      <attributesList
        summary="project_id,start_date,organism,is_reference,steps_count,org_project"
        sorting="steps_count desc"
      />

      <summary>
        For each organism, report how many searches were run.
      </summary>

      <description>
        For each organism, report how many searches were run.

	This data is acquired from the organism parameter in steps stored in the user database.
      </description>

      <dynamicAttributes>

        <columnAttribute name="project_id" displayName="Project collected" align="center"
                         help="Stats collected in this project/website; if 'Unknown' it could be any number of websites,  
                               a subset of requests within the time period requested">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="organism" displayName="Organism" align="center">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="org_project" displayName="Organism website" align="center">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="is_reference" displayName="Is reference?" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="steps_count" displayName="# Searches" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="start_date" displayName="Month"/>
        <columnAttribute name="end_date" displayName="End date"/>

      </dynamicAttributes>

    </question>



    <!-- ************************************************************ -->
    <!-- Gene Page Tables                            -->
    <!-- ************************************************************ -->
    <question name="GenePageTableMetrics"
      displayName="Gene Page Table requests"
      shortDisplayName="Gene Tables"
      queryRef="MetricsId.GenePageTableMetrics"
      recordClassRef="MetricsRecordClasses.MetricsRecordClass"  >

      <attributesList
        summary="project_id,start_date,record_class,table_name,count"
        sorting="count desc"
      />

      <summary>
	Reports on usage of individual WDK tables in the gene page.
      </summary>

      <description>
        How often the user is shown a WDK table section in the gene page.  This will either because the section is open by default or the user explicitly opened it. 

	This data is acquired from prometheus.  Using it, the WDK tracks when the data for a WDK table is requested.  
      </description>

      <dynamicAttributes>

        <columnAttribute name="project_id" displayName="Project collected" align="center"
                         help="Stats collected in this project/website; if 'Unknown' it could be any number of websites,  
                               a subset of requests within the time period requested">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="record_class" displayName="Data type" align="center">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="table_name" displayName="Table name" align="center" help="These are sections in a gene page.">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="count" displayName="# Requests" align="center" 
             help="A request is made when the user opens a section in the geene page, and when the page is reloaded with the section opened.">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="start_date" displayName="Month"/>
        <columnAttribute name="end_date" displayName="End date"/>

      </dynamicAttributes>

    </question>



    <!-- ************************************************************ -->
    <!-- Tools                            -->
    <!-- ************************************************************ -->
    <question name="ToolMetrics"
      displayName="Tool usage"
      shortDisplayName="Tools"
      queryRef="MetricsId.ToolMetrics"
      recordClassRef="MetricsRecordClasses.MetricsRecordClass"  >

      <attributesList
        summary="project_id,start_date,tool,count"
        sorting="count desc"
      />

      <summary>
        Report on tool usage.
      </summary>

      <description>
        Report on tool usage.

	Uses the apache logs (fake count page endpoint)  and the user database to find the usage stats.  May include usage by robots.
      </description>

      <dynamicAttributes>

        <columnAttribute name="project_id" displayName="Project collected" align="center"
                         help="Stats collected in this project/website; if 'Unknown' it could be any number of websites,  
                               a subset of requests within the time period requested">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="tool" displayName="Tool" align="center">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="count" displayName="# Requests" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="start_date" displayName="Month"/>
        <columnAttribute name="end_date" displayName="End date"/>

      </dynamicAttributes>

    </question>


    <!-- ************************************************************ -->
    <!-- Searches: step count                            -->
    <!-- ************************************************************ -->
    <question name="SearchMetrics"
      displayName="Search popularity"
      shortDisplayName="Searches"
      queryRef="MetricsId.SearchMetrics"
      recordClassRef="MetricsRecordClasses.MetricsRecordClass"  >

      <attributesList
        summary="project_id,start_date,record_name,search_name,steps_count"
        sorting="steps_count desc"
      />

      <summary>
	Report the number of times each WDK search is used.
      </summary>

      <description>
	Report the number of times each WDK search is used.

        To get the data, we count in the user database the number of steps that use each step.
      </description>

      <dynamicAttributes>

        <columnAttribute name="project_id" displayName="Project collected" align="center"
                         help="Stats collected in this project/website; if 'Unknown' it could be any number of websites,  
                               a subset of requests within the time period requested">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="record_name" displayName="Data type" align="center">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="search_name" displayName="Search name" align="center">
          <reporter name="wordCloud" displayName="Word Cloud" scopes=""
                    implementation="org.eupathdb.common.model.report.EbrcWordCloudAttributeReporter">
            <description>
              <![CDATA[ Display the terms in the attribute as word clouds ]]>
            </description>
          </reporter>
        </columnAttribute>

        <columnAttribute name="steps_count" displayName="# Steps" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
                    implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>

        <columnAttribute name="start_date" displayName="Month"/>
        <columnAttribute name="end_date" displayName="End date"/>

      </dynamicAttributes>

    </question>

  </questionSet>


</wdkModel>

