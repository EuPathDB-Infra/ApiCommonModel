<wdkModel>
  <paramSet name="compoundParams" excludeProjects="TrichDB,EuPathDB">
        
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Compound IDs -->  
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <datasetParam name="ds_pubchem_compound_id"
		  recordClassRef="CompoundRecordClasses.CompoundRecordClass"
		  prompt="Compound ID">

      <help>
	Enter PubChem compound IDs and/or KEGG compound IDs.
      </help>
      <suggest
	  default="93072"/>
    </datasetParam>


    <flatVocabParam name="pubchem_compound_id"
		    queryRef="CompoundVQ.CompoundID"
		    prompt="Compound ID"
                    multiPick="true"
		    displayType="typeAhead">
      <help> Enter a PubChem compound ID or name.</help>
      <suggest allowEmpty="true" emptyValue="N/A" />
    </flatVocabParam>

    <stringParam name="min_molecular_weight"
		 prompt="Min Molecular Weight (Daltons)"
		 number="true">
      <help>Lower bound for the molecular weight of compound</help>
      <suggest default="800"/>
    </stringParam>

    <stringParam name="max_molecular_weight"
		 prompt="Max Molecular Weight (Daltons)"
		 number="true">
      <help>Upper bound for the molecular weight of compound</help>
      <suggest default="900"/>
    </stringParam>

    <stringParam name="input_formula"
		 prompt="Molecular Formula"
		 number="false">
      <help>Molecular formula of compound. Use '*' for wildcard.</help>
      <suggest default="C6H12*"/>
    </stringParam>

    <enumParam name="text_fields" 
	       prompt="Fields"
	       multiPick="true">
      <noTranslation value="true" includeProjects="EuPathDB" />
      <noTranslation value="false" excludeProjects="EuPathDB" />
      <help>
	Choose which text fields to search.
      </help>
      <enumList>
        <enumValue>
          <term>Name, Property (InChI, IUPAC Name, SMILES, Molecular Weight)</term>
          <internal>Properties</internal>
        </enumValue>
        <enumValue  default="true" >
          <term>Synonym</term>
          <internal>Synonyms</internal>
        </enumValue>
        <enumValue>
          <term>Substance Properties</term>
          <internal>SubstanceProps</internal>
        </enumValue>
        <enumValue >
          <term>Reaction/Pathway/Enzyme</term>
          <internal>CompoundsMetabolicPathways</internal>
        </enumValue>
      </enumList>
    </enumParam>


    <enumParam name="compound_type" 
	       prompt="Compound is a ..."
	       multiPick="false"
	       quote="true">
      <noTranslation value="true" includeProjects="EuPathDB" />
      <help>
	Choose whether the compound should be a substrate, or a product, or both, or either in a reaction.
      </help>
      <enumList>
          <enumValue>
	    <display>substrate</display>
            <term>substrate</term>
            <internal>substrate</internal>
          </enumValue>
          <enumValue>
	    <display>product</display>
            <term>product</term>
            <internal>product</internal>
          </enumValue>
          <enumValue default="true">
            <display>substrate/product (reversible reaction)</display>
            <term>substrate/product</term>
            <internal>substrate/product</internal>
          </enumValue>
          <enumValue>
            <display>either substrate or product</display>
            <term>either</term>
            <internal>either</internal>
          </enumValue>
        </enumList>
    </enumParam>


    <enumParam name="any_or_all_pathway"
                     prompt="Pathways must contain: "
                     multiPick="false"
                     quote="false">
      <noTranslation value="true" includeProjects="EuPathDB" />
      <help>Return pathways associated with ANY of the record entered or return only pathways associated to ALL the records</help>
      <enumList>
        <enumValue default="true">
          <term>any</term>
          <internal>any</internal>
	  <display>any of the specified compounds</display>
        </enumValue>
        <enumValue>
          <term>all</term>
          <internal>all</internal>
	  <display>all of the specified compounds</display>
        </enumValue>  
      </enumList>
    </enumParam>

    <stringParam name="enzyme"
		 prompt="EC Number"
		 number="false">
      <help>Enter EC Number.</help>
      <suggest default="4.1.1.49"/>
    </stringParam>


    <stringParam name="fold_change"
		 prompt="Fold change >="
		 number="true">
      <help>Enter a non-negative number.</help> 
      <suggest default="2"/>
    </stringParam>
    
    <flatVocabParam name="profileset" includeProjects="PlasmoDB"
		    queryRef="CompoundVQ.LlinasMetabolitesProfiles"
		    prompt="Experiment"
		    quote="false"
		    displayType="radioBox" 
		    multiPick="false">
      <help>Choose an Experiment</help> 
    </flatVocabParam>
    
    <flatVocabParam name="samples_fc_ref" includeProjects="PlasmoDB"
		    queryRef="CompoundVQ.LlinasMetabolitesSamples"
		    prompt="Reference Samples"
		    quote="false"
		    displayType="checkBox"
		    multiPick="false"
		    dependedParamRef="compoundParams.profileset">
      <help>Choose a sample.</help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="samples_fc_comp" includeProjects="PlasmoDB"
		    queryRef="CompoundVQ.LlinasMetabolitesSamples"
		    prompt="Comparison Samples"
		    quote="false"
		    displayType="checkBox"
		    multiPick="false"
		    dependedParamRef="compoundParams.profileset">
      <help>Choose a sample. </help>
      <suggest selectMode="none" />
    </flatVocabParam>

    <flatVocabParam name="regulated_dir"
                    prompt="Direction"
                    multiPick="false"
                    quote="false"
                    queryRef="CompoundVQ.regulatedDirection">
    <noTranslation value="true" includeProjects="EuPathDB" />
      <help><![CDATA[
            <ul>
<li>- Select 'up-regulated' to find compounds that have higher expression
in the comparator as compared to the reference.</li><br>
<li>- Select 'down-regulated' to find compounds that have lower expression
in the comparator as compared to the reference.</li><br>
<li>- Select 'up or down regulated' to find compounds that have higher or
lower expression in the comparator as compared to the reference.</li>
</ul>
      ]]></help>
      <suggest default="up or down regulated"/>
    </flatVocabParam>

    <answerParam name="compound_result"
                  prompt="Input Result Set"
                  readonly="true"
                  visible="false">
       <recordClass ref="CompoundRecordClasses.CompoundRecordClass" />
    </answerParam>

  </paramSet>



  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!-- Vocab queries  -->
  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    
  <querySet name="CompoundVQ" queryType="vocab"  isCacheable="true" excludeProjects="TrichDB,EuPathDB">

         <sqlQuery name="CompoundID">
            <column name="internal" />
            <column name="term" />
            <column name="display"/>

            <sql>
	      SELECT compound_id AS internal, display AS term, display
               FROM  ApidbTuning.CompoundTypeAheads
             UNION
               SELECT 'N/A' AS internal, 'N/A' AS term, 'N/A' AS display
               FROM dual
            </sql>
        </sqlQuery>

      <sqlQuery name="LlinasMetabolitesProfiles" includeProjects="PlasmoDB">
             <column name="display"/>
             <column name="internal"/>
             <column name="term"/>
          <sql>
          SELECT name as term, profile_set_id as internal, 
	                  'Effect of pH on metabolite levels (Lewis, Baska and Llinas)' as display 
           FROM apidb.profileset p
           WHERE p.name = 'Profiles of Metabolites from Llinas'
          </sql>
        </sqlQuery>

       <processQuery name="LlinasMetabolitesProfiles" processName="org.apidb.apicomplexa.wsfplugin.apifed.ApiFedPlugin" includeProjects="EuPathDB">
            <wsColumn name="internal" width="300" wsName="internal"/>
            <wsColumn name="term" width="300" wsName="term"/>
            <wsColumn name="display" width="300" wsName="display"/>
        </processQuery>

      <sqlQuery name="LlinasMetabolitesSamples" includeProjects="PlasmoDB">
             <paramRef ref="compoundParams.profileset"/>
             <column name="internal"/>
             <column name="term"/>
             <column name="display"/>
          <sql>
          SELECT name AS term, name AS display,
                 profile_element_name_id AS internal
          FROM apidb.profileElementName 
          WHERE profile_set_id = '$$profileset$$'
          ORDER BY element_order
          </sql>
        </sqlQuery>
      <processQuery name="LlinasMetabolitesSamples" processName="org.apidb.apicomplexa.wsfplugin.apifed.ApiFedPlugin" includeProjects="EuPathDB">
            <paramRef ref="compoundParams.profileset"/>
            <wsColumn name="internal" width="100" wsName="internal"/>
            <wsColumn name="term" width="100" wsName="term"/>
            <wsColumn name="display" width="100" wsName="display"/>
        </processQuery>

        <sqlQuery name="regulatedDirection"  excludeProjects="EuPathDB">
            <column name="internal" />
            <column name="term" />
            <sql>
            SELECT 'up or down regulated' as term, 'abs' as internal from dual
            UNION
            SELECT 'down-regulated' as term, '-' as internal from dual
            UNION
            SELECT 'up-regulated' as term, '+' as internal from dual
            </sql>
        </sqlQuery>

        <processQuery name="regulatedDirection" processName="org.apidb.apicomplexa.wsfplugin.apifed.ApiFedPlugin" includeProjects="EuPathDB" doNotTest="1">
            <wsColumn name="internal" width="100" wsName="internal"/>
            <wsColumn name="term" width="200" wsName="term"/>
        </processQuery>


    </querySet>

</wdkModel>
