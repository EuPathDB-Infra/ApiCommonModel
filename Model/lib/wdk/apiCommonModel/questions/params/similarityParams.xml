<wdkModel>
  
  <paramSet name="genomicSimilarityParams">

       <flatVocabParam name="motif_organism"
                      queryRef="SimilarityVQ.GenomicMotifFiles"
                      displayType="treeBox"
                      suppressNode="true"  
                      prompt="Organism"
                      multiPick="true">
      <noTranslation value="true" includeProjects="EuPathDB" />
      <noTranslation value="false" excludeProjects="EuPathDB" />

         <help>
             Choose one or more organisms to search with the given motif
         </help>
       </flatVocabParam>

  </paramSet>

  <paramSet name="orfSimilarityParams">

       <flatVocabParam name="motif_organism"
                      queryRef="SimilarityVQ.OrfMotifFiles"
                      displayType="treeBox"  
                      suppressNode="true"
                      prompt="Organism"
                      multiPick="true">
      <noTranslation value="true" includeProjects="EuPathDB" />
      <noTranslation value="false" excludeProjects="EuPathDB" />

         <help>
             Choose one or more organisms to search with the given motif
         </help>
       </flatVocabParam>


  </paramSet>
  

  <paramSet name="geneSimilarityParams">
  

       <flatVocabParam name="motif_organism"
                      queryRef="SimilarityVQ.AnnotatedProteinMotifFiles"
                      displayType="treeBox"
                      suppressNode="true" 
                      prompt="Organism"
                      multiPick="true">
      <noTranslation value="true" includeProjects="EuPathDB" />
      <noTranslation value="false" excludeProjects="EuPathDB" />

         <help>
             Choose one or more organisms to search with the given motif
         </help>
       </flatVocabParam>
     
  </paramSet>

  <querySet name="SimilarityVQ" queryType="vocab">


        <sqlQuery name="OrfMotifFiles">
            <column name="internal" />
            <column name="parentTerm"/>
            <column name="term" />
            <sql>
                <![CDATA[ 
                WITH orgs as (select distinct organism, project_id
                      from ApidbTuning.SequenceAttributes
  UNION
  -- GiardiaDB uses species for everything  
  select distinct species, project_id
  from ApidbTuning.GeneAttributes
  where project_id = 'GiardiaDB'
  UNION
    -- ToxoDB Apicoplast for GENES and GENOMES
  select 'Toxoplasma gondii apicoplast' as organism, 'ToxoDB' as project_id
  from dual
  UNION
  -- Mitochondrial GENES and GENOME
  select distinct organism || ' mitochondrial', project_id
  from ApidbTuning.SequenceAttributes
  where so_id = 'SO:0000819'
  UNION
  -- Plastid GENES and GENOME
  select distinct organism || ' plastid' as organism, project_id
  from ApidbTuning.SequenceAttributes
  where so_id = 'SO:0001259'
  UNION
   -- CryptoDB has ESTORFs
  select 'Cryptosporidium parvum EST' as organism,  'CryptoDB' as project_id from dual
  UNION 
  select 'Cryptosporidium muris EST' as organism,  'CryptoDB' as project_id from dual)   
                select abbrev.parent as parentTerm, 
                       abbrev.organism as term,
                       abbrev.abbreviation || 'ORFs'  || '_' || orgs.project_id || '.fasta' as internal
               From ApidbTuning.OrganismAbbreviationws abbrev,  orgs
               where orgs.organism = abbrev.organism
               and (orgs.project_id = '@PROJECT_ID@' OR 'EuPathDB' = '@PROJECT_ID@')
               UNION
               select ot.parentTerm as parentTerm,ot.term as term,'-1'as internal
               from ApidbTuning.OrganismTree ot, ApidbTuning.OrganismAbbreviationWS abbrev,
               orgs
               where orgs.organism = abbrev.organism
               and (orgs.project_id = '@PROJECT_ID@' OR 'EuPathDB' = '@PROJECT_ID@')
               and ot.term = abbrev.parent
               UNION
               select ot.parentTerm as parentTerm,ot.term as term,'-1'as internal
               from ApidbTuning.OrganismTree ot
               where ot.term in (select ot.parentTerm 
               from ApidbTuning.OrganismTree ot, ApidbTuning.OrganismAbbreviationWS abbrev, orgs
               where orgs.organism = abbrev.organism
               and orgs.organism = abbrev.organism
               and (orgs.project_id = '@PROJECT_ID@' OR 'EuPathDB' = '@PROJECT_ID@') 
               and ot.term = abbrev.parent)
               UNION 
               select ot.parentTerm as parentTerm,ot.term as term,'-1'as internal
               from ApidbTuning.OrganismTree ot
               where ot.term in (select ot.parentTerm from (select ot.parentTerm from ApidbTuning.OrganismTree ot, ApidbTuning.OrganismAbbreviationWS abbrev, orgs
               where orgs.organism = abbrev.organism
               and ot.term = abbrev.parent
               and (ot.project_id = 'EuPathDB' or '@PROJECT_ID@' = 'EuPathDB'))pt,  ApidbTuning.OrganismTree ot
               where pt.parentTerm = ot.term)
                ]]>
            </sql>
        </sqlQuery>

        <sqlQuery name="GenomicMotifFiles">
            <column name="internal" />
            <column name="parentTerm" />
            <column name="term" />
            <sql>
                <![CDATA[ 
                with orgs as  (select distinct organism, project_id
                      from ApidbTuning.SequenceAttributes
  UNION
  -- GiardiaDB Scaffolds
  select 'Giardia Assemblage A isolate WB (scaffolds)' as organism, 'GiardiaDB' as project_id
  from dual
  UNION
  select distinct species, project_id
  from ApidbTuning.GeneAttributes
  where project_id = 'GiardiaDB'
  UNION
    -- ToxoDB Apicoplast for GENES and GENOMES
  select 'Toxoplasma gondii apicoplast' as organism, 'ToxoDB' as project_id
  from dual
  UNION
  -- Mitochondrial GENES and GENOME
  select distinct organism || ' mitochondrial', project_id
  from ApidbTuning.SequenceAttributes
  where so_id = 'SO:0000819'
  UNION
  -- Plastid GENES and GENOME
  select distinct organism || ' plastid' as organism, project_id
  from ApidbTuning.SequenceAttributes
  where so_id = 'SO:0001259'
                      )
                select  abbrev.parent as parentTerm, abbrev.organism as term, abbrev.abbreviation || 'Genomic'  || '_' || orgs.project_id || '.fasta' as internal
                From ApidbTuning.OrganismAbbreviationws abbrev, orgs
               where orgs.organism = abbrev.organism
               and (orgs.project_id = '@PROJECT_ID@' OR 'EuPathDB' = '@PROJECT_ID@')
               UNION
               select ot.parentTerm as parentTerm,ot.term as term,'-1'as internal
               from ApidbTuning.OrganismTree ot, ApidbTuning.OrganismAbbreviationWS abbrev,
               orgs
               where orgs.organism = abbrev.organism
               and (orgs.project_id = '@PROJECT_ID@' OR 'EuPathDB' = '@PROJECT_ID@')
               and ot.term = abbrev.parent
               UNION
               select ot.parentTerm as parentTerm,ot.term as term,'-1'as internal
               from ApidbTuning.OrganismTree ot
               where ot.term in (select ot.parentTerm 
               from ApidbTuning.OrganismTree ot, ApidbTuning.OrganismAbbreviationWS abbrev, orgs
               where orgs.organism = abbrev.organism
               and orgs.organism = abbrev.organism
               and (orgs.project_id = '@PROJECT_ID@' OR 'EuPathDB' = '@PROJECT_ID@') 
               and ot.term = abbrev.parent)
               UNION 
               select ot.parentTerm as parentTerm,ot.term as term,'-1'as internal
               from ApidbTuning.OrganismTree ot
               where ot.term in (select ot.parentTerm from (select ot.parentTerm from ApidbTuning.OrganismTree ot, ApidbTuning.OrganismAbbreviationWS abbrev, orgs
               where orgs.organism = abbrev.organism
               and ot.term = abbrev.parent
               and (ot.project_id = 'EuPathDB' or '@PROJECT_ID@' = 'EuPathDB'))pt,  ApidbTuning.OrganismTree ot
               where pt.parentTerm = ot.term)
              
                ]]>
            </sql>
        </sqlQuery>

        <sqlQuery name="AnnotatedProteinMotifFiles">
            <column name="internal" />
            <column name="parentTerm" />
            <column name="term" />
            <sql>
                <![CDATA[ 
                with orgs as (select distinct organism, project_id
                      from ApidbTuning.GeneAttributes 
                      where organism not in ('Toxoplasma gondii RH')
  UNION
  -- TrichDB Repeat Genes
  select distinct organism || ' (Repeated Genes)', project_id
  from ApidbTuning.GeneAttributes
  where project_id = 'TrichDB'
  UNION
  -- GiardiaDB uses species for everything  
  select distinct species, project_id
  from ApidbTuning.GeneAttributes
  where project_id = 'GiardiaDB'
  UNION
  -- GiardiaDB Deprecated Genes
  select 'Giardia Assemblage A isolate WB (deprecated)' as organism, 'GiardiaDB' as project_id
  from dual
  UNION
    -- ToxoDB Apicoplast for GENES and GENOMES
  select 'Toxoplasma gondii apicoplast' as organism, 'ToxoDB' as project_id
  from dual
  UNION  
  -- Mitochondrial GENES
  select distinct organism || ' mitochondrial', project_id
  from ApidbTuning.SequenceAttributes
  where so_id = 'SO:0000819'
  UNION
  -- Plastid GENES
  select distinct organism || ' plastid' as organism, project_id
  from ApidbTuning.SequenceAttributes
  where so_id = 'SO:0001259'
                      )
                select abbrev.parent as parentTerm, abbrev.organism as term, abbrev.abbreviation || 'AnnotatedProteins'  || '_' || orgs.project_id || '.fasta' as internal
               From ApidbTuning.OrganismAbbreviationws abbrev, orgs
               where orgs.organism = abbrev.organism
               and (orgs.project_id = '@PROJECT_ID@' OR 'EuPathDB' = '@PROJECT_ID@')
               UNION
               select ot.parentTerm as parentTerm,ot.term as term,'-1'as internal
               from ApidbTuning.OrganismTree ot, ApidbTuning.OrganismAbbreviationWS abbrev,
               ApidbTuning.OrganismTree pt,orgs
               where orgs.organism = abbrev.organism
               and (orgs.project_id = '@PROJECT_ID@' OR 'EuPathDB' = '@PROJECT_ID@')
               and ot.term = abbrev.parent
               or ot.term in (select ot.parentTerm 
               from ApidbTuning.OrganismTree ot, ApidbTuning.OrganismAbbreviationWS abbrev, orgs
               where orgs.organism = abbrev.organism
               and orgs.organism = abbrev.organism
               and (orgs.project_id = '@PROJECT_ID@' OR 'EuPathDB' = '@PROJECT_ID@') 
               and ot.term = abbrev.parent)               
                ]]>
            </sql>
        </sqlQuery>
       
       
 </querySet>


</wdkModel>

