<wdkModel>

  <!-- notes

  -->

  <querySet name="DataSourceIds" queryType="id">

    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Source id  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <sqlQuery name="AllDataSources" includeProjects="PlasmoDB, TriTrypDB,FungiDB,InitDB,PiroplasmaDB,FungiDB"
         isCacheable="true">
        <column name="data_source_name"/>
        <column name="project_id"/>
        <sql>
          <![CDATA[
            SELECT DISTINCT ds.name as data_source_name, ds.project_id
            FROM   ApiDB.DataSource ds, apidb.DataSourceInfo dsi
            WHERE ds.project_id = '@PROJECT_ID@'
              AND dsi.data_source_id = ds.data_source_id
              AND dsi.categories != 'ignore'
          ]]>
       </sql>
    </sqlQuery>

    <sqlQuery name="ByQuestionName" includeProjects="PlasmoDB, TriTrypDB,FungiDB,InitDB,PiroplasmaDB,FungiDB"
         isCacheable="true">
        <testParamValues includeProjects="PiroplasmaDB">
          <paramValue name="question_name">GeneQuestions.GenesByTextSearch</paramValue>
        </testParamValues>

        <paramRef ref="dataSourceParams.question_name"/>
        <column name="data_source_name"/>
        <column name="project_id"/>
        <sql>
          <![CDATA[
            SELECT DISTINCT ds.name as data_source_name, ds.project_id
            FROM   ApiDB.DataSource ds, apidb.DataSourceInfo dsi, ApiDB.DataSourceInfoReference dsr
            WHERE dsr.target_type = 'question'
              AND dsr.target_name = $$question_name$$ 
              AND dsr.data_source_id = ds.data_source_id
              AND ds.data_source_id = dsi.data_source_id
              AND ds.project_id = '@PROJECT_ID@'
              AND dsi.categories != 'ignore'
          ]]>
       </sql>
    </sqlQuery>

    <sqlQuery name="ByRecordClass" includeProjects="PlasmoDB, TriTrypDB,FungiDB,InitDB,PiroplasmaDB,FungiDB"
         isCacheable="true">
        <testParamValues includeProjects="PiroplasmaDB">
          <paramValue name="record_class">GeneRecordClasses.GeneRecordClass</paramValue>
        </testParamValues>

        <paramRef ref="dataSourceParams.record_class"/>
        <column name="data_source_name"/>
        <column name="project_id"/>
        <sql>
          <![CDATA[
            SELECT DISTINCT ds.name as data_source_name, ds.project_id
            FROM   ApiDB.DataSource ds, apidb.DataSourceInfo dsi, ApiDB.DataSourceInfoReference dsr
            WHERE dsr.target_type IN ('table', 'attribute')
              AND dsr.record_type = $$record_class$$
              AND ds.data_source_id = dsr.data_source_id
              AND ds.data_source_id = dsi.data_source_id
              AND ds.project_id = '@PROJECT_ID@'
              AND dsi.categories != 'ignore'  
          ]]>
       </sql>
    </sqlQuery>


  </querySet>
</wdkModel>
