<wdkModel>
  <querySet name="CompoundIds" queryType="id"
	    includeProjects="PlasmoDB,EuPathDB">

    <!-- ************************************************************ -->
    <!-- Compound Id -->  
    <!-- ************************************************************ -->
 
    <sqlQuery name="CompoundsByCompoundID" doNotTest="true"  excludeProjects="EuPathDB"
              displayName="ID" isCacheable="true">
        <paramRef ref="compoundParams.pubchem_compound_id"/>
        <column name="project_id"/>
        <column name="source_id"/>
        <sql>
            <![CDATA[
            SELECT DISTINCT compound_id as source_id,'@PROJECT_ID@' as project_id
              FROM ApiDB.PubChemCompound
	      WHERE compound_id LIKE REGEXP_REPLACE(REPLACE( $$pubchem_compound_id$$, '*', '%'), '[[:space:]]', '')

               ]]>
        </sql>
    </sqlQuery>

    <processQuery name="CompoundsByCompoundID" includeProjects="EuPathDB"
          isCacheable='true' doNotTest="true"
          processName="org.apidb.apicomplexa.wsfplugin.apifed.ApiFedPlugin"> 
        <paramRef ref="compoundParams.pubchem_compound_id" noTranslation="true"/>
        <wsColumn name="source_id" width="50" wsName="source_id"/>
        <wsColumn name="project_id" width="32" wsName="project_id"/>
    </processQuery>   



    <!-- ************************************************************ -->
    <!-- Compound By Gene ID -->  
    <!-- ************************************************************ -->
 
    <sqlQuery name="CompoundsByGeneID" doNotTest="true"  excludeProjects="EuPathDB"
              displayName="ID by gene" isCacheable="true">

      <paramRef ref="estParams.single_gene_id"/>
      <column name="project_id"/>
      <column name="source_id"/>
      <column name="compound"/>
      <column name="enzyme"/>
      <sql>
	<![CDATA[
       SELECT DISTINCT pc.pubchem_compound_id as source_id, compound, 
              enzyme, '@PROJECT_ID@' as project_id
         FROM dots.Transcript t, dots.translatedAaFeature taf, sres.enzymeClass ec, 
              dots.aaSequenceEnzymeClass asec, ApidbTuning.GeneId gi, ApidbTuning.GeneAttributes ga,
              apidbtuning.PathwayCompounds pc
        WHERE lower(gi.id) LIKE REGEXP_REPLACE(REPLACE(LOWER($$single_gene_id$$), '*', '%'),'[[:space:]]', '')
          AND ga.source_id = gi.gene
          AND ga.na_feature_id = t.parent_id
          AND t.na_feature_id = taf.na_feature_id
          AND taf.aa_sequence_id = asec.aa_sequence_id
          AND asec.enzyme_class_id = ec.enzyme_class_id
          AND pc.enzyme = ec.ec_number
	]]>
        </sql>
    </sqlQuery>

    <processQuery name="CompoundsByGeneID" includeProjects="EuPathDB"
		  isCacheable='true' doNotTest="true"
		  processName="org.apidb.apicomplexa.wsfplugin.apifed.ApiFedPlugin"> 
      <paramRef ref="pathwayParams.metabolic_pathway_id" noTranslation="true"/>
      <wsColumn name="source_id" width="50" wsName="source_id"/>
      <wsColumn name="project_id" width="32" wsName="project_id"/>
      <wsColumn name="compound" width="32"/>   
      <wsColumn name="enzyme" width="32"/>   
    </processQuery>   


    <sqlQuery name="CompoundsByPathway" doNotTest="true"  excludeProjects="EuPathDB"
              displayName="compounds by pathway" isCacheable="true">

      <paramRef ref="pathwayParams.metabolic_pathway_id"/>
      <column name="project_id"/>
      <column name="source_id"/>
      <column name="compound"/>
      <sql>
	<![CDATA[
            SELECT DISTINCT pubchem_compound_id as source_id,
                   compound, '@PROJECT_ID@' as project_id
	    FROM apidbtuning.PathwayCompounds
            WHERE network_id in ($$metabolic_pathway_id$$)                                               
	    ]]>
        </sql>
    </sqlQuery>

    <processQuery name="CompoundsByPathway" includeProjects="EuPathDB"
		  isCacheable='true' doNotTest="true"
		  processName="org.apidb.apicomplexa.wsfplugin.apifed.ApiFedPlugin"> 
      <paramRef ref="estParams.single_gene_id" noTranslation="true"/>
      <wsColumn name="source_id" width="50" wsName="source_id"/>
      <wsColumn name="project_id" width="32" wsName="project_id"/>
      <wsColumn name="compound" width="32"/>   
    </processQuery>   


    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Molecular Weight -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <sqlQuery name="CompoundsByMolecularWeight" excludeProjects="EuPathDB"
              isCacheable="true">
        <paramRef ref="compoundParams.min_molecular_weight"/>
        <paramRef ref="compoundParams.max_molecular_weight"/>
        <column name="project_id"/>
        <column name="source_id"/>
	<column name="molecular_wt"/>
        <sql>
            <![CDATA[
            SELECT DISTINCT compound_id as source_id, value as molecular_wt,  
                   '@PROJECT_ID@' as project_id
	    FROM ApiDB.PubChemCompound
	    WHERE property='Molecular Weight'
	      AND value <= $$max_molecular_weight$$
              AND value >= $$min_molecular_weight$$
           ]]>
       </sql>
    </sqlQuery>

    <processQuery name="CompoundsByMolecularWeight" includeProjects="EuPathDB"
		  isCacheable='true'
		  processName="org.apidb.apicomplexa.wsfplugin.apifed.ApiFedPlugin">
      <paramRef ref="compoundParams.min_molecular_weight"/>
      <paramRef ref="compoundParams.max_molecular_weight"/>
      <wsColumn name="source_id" width="50" wsName="source_id"/>
      <wsColumn name="project_id" width="20" wsName="project_id"/>
      <wsColumn name="molecular_wt" width="32"/>   
    </processQuery>


   </querySet>

</wdkModel>
