<wdkModel>
  <querySet name="PathwayIds" queryType="id">

    <!-- ************************************************************ -->
    <!-- Pathway Name -->  
    <!-- ************************************************************ -->
 
    <sqlQuery name="PathwaysByPathwayID" doNotTest="true"  excludeProjects="EuPathDB"
              displayName="ID" isCacheable="true">
        <paramRef ref="pathwayParams.metabolic_pathway_id"/>
        <column name="project_id"/>
        <column name="source_id"/>
        <sql>
            <![CDATA[
            SELECT DISTINCT n.name as source_id, '@PROJECT_ID@' as project_id
            FROM   ApiDB.Network n
            WHERE  n.network_id in ($$metabolic_pathway_id$$)
               ]]>
        </sql>
    </sqlQuery>

    <processQuery name="PathwaysByPathwayID" includeProjects="EuPathDB"
          isCacheable='true' doNotTest="true"
          processName="org.apidb.apicomplexa.wsfplugin.apifed.ApiFedPlugin"> 
        <paramRef ref="pathwayParams.metabolic_pathway_id" noTranslation="true"/>
        <wsColumn name="source_id" width="50" wsName="source_id"/>
        <wsColumn name="project_id" width="32" wsName="project_id"/>
    </processQuery>   

    <!-- ************************************************************ -->
    <!-- Gene List -->  
    <!-- ************************************************************ -->
 
    <sqlQuery name="PathwaysByGeneList" doNotTest="true"  excludeProjects="EuPathDB"
              displayName="ID" isCacheable="true">
        <paramRef ref="sharedParams.ds_gene_ids" excludeProjects="CryptoDB,ToxoDB"/>
        <paramRef ref="sharedParams.ds_gene_ids" default="TGGT1_036630" includeProjects="ToxoDB"/>
        <paramRef ref="sharedParams.ds_gene_ids" default="cgd3_510" includeProjects="CryptoDB"/>
        <column name="project_id"/>
        <column name="source_id"/>
        <sql>
            <![CDATA[
            SELECT DISTINCT n.name as source_id, '@PROJECT_ID@' as project_id
from   ($$ds_gene_ids$$) ds, dots.Transcript t, dots.translatedAaFeature taf, sres.enzymeClass ec,
       dots.aaSequenceEnzymeClass asec,ApidbTuning.GeneId gi, ApidbTuning.GeneAttributes ga,
       apidb.networkrelationship nr, apidb.networkrelationshiptype nrt,
       ApiDB.NetworkRelContext nrc,  apidb.Network n, ApiDB.NetworkRelContextLink nrl, apidb.networknode nn
where  ga.na_feature_id = t.parent_id
AND    lower(gi.id) = lower(ds.source_id)
AND    ga.source_id = gi.gene
AND    t.na_feature_id = taf.na_feature_id
AND    taf.aa_sequence_id = asec.aa_sequence_id
AND    asec.enzyme_class_id = ec.enzyme_class_id
and    nn.display_label = ec.ec_number
and    nr.associated_node_id = nn.network_node_id
and    nrc.network_relationship_id = nr.network_relationship_id
and    nrt.network_relationship_type_id = nrc.network_relationship_type_id
and    nrl.network_rel_context_id = nrc.network_rel_context_id
and    nrl.network_id = n.network_id
               ]]>
        </sql>
    </sqlQuery>

    <processQuery name="PathwaysByGeneList" includeProjects="EuPathDB"
          isCacheable='true' doNotTest="true"
          processName="org.apidb.apicomplexa.wsfplugin.apifed.ApiFedPlugin"> 
        <paramRef ref="sharedParams.ds_gene_ids"  noTranslation="true"/>
        <wsColumn name="source_id" width="50" wsName="source_id"/>
        <wsColumn name="project_id" width="32" wsName="project_id"/>
    </processQuery>   

   </querySet>

</wdkModel>
