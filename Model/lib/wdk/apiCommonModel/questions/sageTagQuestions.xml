<wdkModel>

  <questionSet name="SageTagQuestions"
               displayName="Search for SAGE Tags"
               includeProjects="EuPathDB,ToxoDB,TriTrypDB,PlasmoDB,GiardiaDB">

<!--

0. Find SAGE tags by genomic location
1. Find SAGE tag by sequence
2. Find SAGE tags by gene source_id
3. Find SAGE tags by expression level(count), experiment(library)
  - greater than some percentage or count in a given experiment
4. Find SAGE tags by rad_source_id(include giardiadb only)
5. Find all SAGE tags that align to less than some number of genes 
       OR Find all SAGE tags that align globally to less than some number of places
6.R value
-->

    <question name="SageTagByRStat"
              searchCategory="Other Attributes"
              displayName="Differential Expression"
              shortDisplayName="Diff Expr"
              queryRef="SageTagIds.ByRStat"
              recordClassRef="SageTagRecordClasses.SageTagRecordClass"
              noSummaryOnSingleRecord="false" 
              includeProjects="ToxoDB,PlasmoDB,EuPathDB,GiardiaDB,TriTrypDB">

             <attributesList 
               summary="gene_source_id, gene_product,location_text,tag_sequence,R"
               sorting="organism asc, R desc"
             />
             <summary excludeProjects="TriTrypDB">
               Find SAGE Tags that are differentially expressed across 2 or more libraries.
             </summary>
             <summary includeProjects="TriTrypDB">
               Find DGE Tags that are differentially expressed across 2 or more libraries.
             </summary>
             <description includeProjects="PlasmoDB,EuPathDB,GiardiaDB,TriTrypDB">
           <![CDATA[
            <p>Find SAGE Tags with evidence of differential expression by choosing libraries (more than one) to compare across.  A large R value indicates differential expression.

Stekel DJ, Git Y, Falciani F. <a href="http://www.ncbi.nlm.nih.gov/sites/entrez?cmd=Retrieve&db=PubMed&list_uids=11116099">The comparison of gene expression from multiple cDNA libraries.</a>  Genome Res.  2000.  Dec:10(12):2055-61.
</p>               
<p>See the related <a href="showQuestion.do?questionFullName=GeneQuestions.GenesBySageTagRStat"><b>Genes by Differential Expression of SAGE Tag Evidence</b></a> query for summing SAGE tag counts within predicted genes.
</p>
          ]]>
             </description>
<description includeProjects="ToxoDB">
           <![CDATA[
            <p>Find SAGE Tags with evidence of differential expression by choosing libraries (more than one) to compare across.  A large R value indicates differential expression.

Stekel DJ, Git Y, Falciani F. <a href="http://www.ncbi.nlm.nih.gov/sites/entrez?cmd=Retrieve&db=PubMed&list_uids=11116099">The comparison of gene expression from multiple cDNA libraries.</a>  Genome Res.  2000.  Dec:10(12):2055-61.
</p>               
<p>See the related <a href="showQuestion.do?questionFullName=GeneQuestions.GenesBySageTagRStat"><b>Genes by Differential Expression of SAGE Tag Evidence</b></a> query for summing SAGE tag counts within predicted genes.
</p>
The data available here is from a study conducted by <a href ="http://www.ncbi.nlm.nih.gov/pubmed/16324218">Radke et. al. </a> where SAGE tag libraries were generated from <i>T. gondii</i> parasites at specific stages of development.  The data available through ToxoDB includes 3' (3p) SAGE tag libraries only. Abbreviations are as follows:<br>
sp&nbsp;&nbsp;&nbsp;= Oocyst population that contains sporozoites (VEG strain).<br>
d4&nbsp;&nbsp;&nbsp;= Day 4 parasites (post-inoculation of human forskin fibroblast cells (HFFs)). <br>
d6&nbsp;&nbsp;&nbsp;= Day 6 parasites (post-inoculation of HFFs) -- rapidly growing in the second host cell. <br>
d7&nbsp;&nbsp;&nbsp;= Day 7 parasites (post-inoculation of HFFs) -- parasites undergo a growth shift at this point. <br>
d15&nbsp;= Day 15 parasites (post-inoculation of HFFs) -- The parasites are slow growing and include a mixture of tachyzoites and bradyzoites. <br>
ph&nbsp;&nbsp;&nbsp;= VEG parasites that were alkaline-differentiated into bradyzoites for 72 hours. <br>
rh&nbsp;&nbsp;&nbsp;&nbsp;= TypeI-RH. <br>
b7&nbsp;&nbsp;&nbsp;= TypeII-ME49B7. <br>
msj&nbsp;= TypeIII-VEGmsj. <br>
          ]]>
             </description>

        <dynamicAttributes>
             <columnAttribute name="R" displayName="R"
                              inReportMaker="false"/>
         </dynamicAttributes>
       <propertyList name="specificAttribution">
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagArrayDesign</value>
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagFreqs</value>
           <value includeProjects="EuPathDB,TriTrypDB">TrypSageTagFreqs</value>
           <value includeProjects="EuPathDB,ToxoDB">3primeToxoSageTags</value>
          <!--  <value includeProjects="EuPathDB,ToxoDB">5primeToxoSageTags</value> -->
           <!-- <value includeProjects="EuPathDB,ToxoDB">ToxoSageTagFreqs</value> -->
           <value includeProjects="EuPathDB,PlasmoDB">SageTagArrayDesign</value>
           <value includeProjects="EuPathDB,PlasmoDB">PlasmoSageTagFreqs</value>
       </propertyList>

     </question>


    <question name="SageTagByLocation"
              searchCategory="Other Attributes"
              displayName="Genomic Location"
              shortDisplayName="Genomic Loc"
              queryRef="SageTagIds.ByLocation"
              recordClassRef="SageTagRecordClasses.SageTagRecordClass"
              noSummaryOnSingleRecord="false" 
              includeProjects="EuPathDB,GiardiaDB,PlasmoDB,ToxoDB">

             <attributesList 
               summary="gene_source_id,gene_product,dynamic_location,tag_sequence"
               sorting="dynamic_location asc"
             />

            <dynamicAttributes>
              <columnAttribute name="dynamic_location" displayName="Location" align="left"/>
            </dynamicAttributes>
 
             <summary includeProjects="TriTrypDB">
               Find DGE Tags that are located in a specified genomic region.
             </summary>
             <summary excludeProjects="TriTrypDB">
               Find SAGE Tags that are located in a specified genomic region.
             </summary>
             <description excludeProjects="TriTrypDB">
               Find SAGE Tags that are located in a specified genomic region.
             </description>
             <description includeProjects="TriTrypDB">
               Find DGE Tags that are located in a specified genomic region.
             </description>

      <propertyList name="specificAttribution">
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagArrayDesign</value>
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagFreqs</value>
           <value includeProjects="EuPathDB,TriTrypDB">TrypSageTagFreqs</value>
           <value includeProjects="EuPathDB,ToxoDB">3primeToxoSageTags</value>
           <!-- <value includeProjects="EuPathDB,ToxoDB">5primeToxoSageTags</value> -->
           <!-- <value includeProjects="EuPathDB,ToxoDB">ToxoSageTagFreqs</value> -->
           <value includeProjects="EuPathDB,PlasmoDB">SageTagArrayDesign</value>
           <value includeProjects="EuPathDB,PlasmoDB">PlasmoSageTagFreqs</value>
       </propertyList>

    </question>



    <question name="SageTagBySequence" 
              searchCategory="Other Attributes"
              displayName="Sequence"
              shortDisplayName="Sequence"
              queryRef="SageTagIds.BySequence" 
              recordClassRef="SageTagRecordClasses.SageTagRecordClass"
              noSummaryOnSingleRecord="false" 
              includeProjects="ToxoDB, PlasmoDB,EuPathDB,GiardiaDB,TriTrypDB">

             <attributesList 
               summary="gene_source_id,gene_product,location_text,tag_sequence"
               sorting="organism asc, tag_sequence asc"
             />
             <summary excludeProjects="TriTrypDB">
               Find SAGE Tags Alignments By their Sequence.
             </summary>
             <summary includeProjects="TriTrypDB">
               Find DGE Tags Alignments By their Sequence.
             </summary>
             <description excludeProjects="TriTrypDB">
               Find SAGE Tags Alignments By their Sequence.
             </description>
             <description includeProjects="TriTrypDB">
               Find DGE Tags Alignments By their Sequence.
             </description>

     <propertyList name="specificAttribution">
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagArrayDesign</value>
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagFreqs</value>
           <value includeProjects="EuPathDB,TriTrypDB">TrypSageTagFreqs</value>
           <value includeProjects="EuPathDB,ToxoDB">3primeToxoSageTags</value>
           <!-- <value includeProjects="EuPathDB,ToxoDB">5primeToxoSageTags</value> -->
           <!-- <value includeProjects="EuPathDB,ToxoDB">ToxoSageTagFreqs</value> -->
           <value includeProjects="EuPathDB,PlasmoDB">SageTagArrayDesign</value>
           <value includeProjects="EuPathDB,PlasmoDB">PlasmoSageTagFreqs</value>
       </propertyList>

    </question>

    <question name="SageTagByGeneSourceId" 
              searchCategory="Other Attributes"
              displayName="Gene ID"
              shortDisplayName="Gene ID"
              queryRef="SageTagIds.ByGeneSourceId" 
              recordClassRef="SageTagRecordClasses.SageTagRecordClass"
              noSummaryOnSingleRecord="true" 
              includeProjects="ToxoDB,PlasmoDB,GiardiaDB">

             <attributesList 
               summary="gene_source_id,gene_product,location_text,tag_sequence"
               sorting="organism asc"
             />
             <summary excludeProjects="TriTrypDB">
               Find SAGE Tags By Gene Identifier
             </summary>
             <summary includeProjects="TriTrypDB">
               Find DGE Tags By Gene Identifier
             </summary>
             <description excludeProjects="TriTrypDB">
               Find SAGE Tags By Gene Identifier
             </description>
             <description includeProjects="TriTrypDB">
               Find DGE Tags By Gene Identifier
             </description>
      <propertyList name="specificAttribution">
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagArrayDesign</value>
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagFreqs</value>
           <value includeProjects="EuPathDB,TriTrypDB">TrypSageTagFreqs</value>
           <value includeProjects="EuPathDB,ToxoDB">3primeToxoSageTags</value>
           <!-- <value includeProjects="EuPathDB,ToxoDB">5primeToxoSageTags</value> -->
           <!-- <value includeProjects="EuPathDB,ToxoDB">ToxoSageTagFreqs</value> -->
           <value includeProjects="EuPathDB,PlasmoDB">SageTagArrayDesign</value>
           <value includeProjects="EuPathDB,PlasmoDB">PlasmoSageTagFreqs</value>
       </propertyList>

    </question> 
 
	<question name="SageTagByGeneSourceId" 
              searchCategory="Other Attributes"
              displayName="GeneSource Id"
              shortDisplayName="GeneSource Id"
              queryRef="SageTagIds.ByGeneSourceId" 
              recordClassRef="SageTagRecordClasses.SageTagRecordClass"
              includeProjects="EuPathDB">

             <attributesList 
               summary="gene_source_id,gene_product,location_text,tag_sequence"
               sorting="organism asc"
             />
             <summary excludeProjects="TriTrypDB">
               Find SAGE Tags in GiardiaDB, PlasmoDB and ToxoDB By Gene Identifier
             </summary>
             <summary includeProjects="TriTrypDB">
               Find DGE Tags in TriTrypDB By Gene Identifier
             </summary>
             <description excludeProjects="TriTrypDB">
               Find SAGE Tags in GiardiaDB, TriTrypDB, PlasmoDB and ToxoDB By Gene Identifier
             </description>
             <description includeProjects="TriTrypDB">
               Find DGE Tags in GiardiaDB, TriTrypDB, PlasmoDB and ToxoDB By Gene Identifier
             </description>
    
    </question> 
    


   <question name="SageTagByExpressionLevel" 
              searchCategory="Other Attributes"
              displayName="Expression Level"
              shortDisplayName="Expr Level"
              queryRef="SageTagIds.ByExpressionLevel" 
              recordClassRef="SageTagRecordClasses.SageTagRecordClass"
              noSummaryOnSingleRecord="false" 
              includeProjects="ToxoDB,PlasmoDB,EuPathDB,GiardiaDB,TriTrypDB">

             <attributesList 
               summary="gene_source_id,gene_product,location_text,tag_sequence, SAGE_library, tag_count,tag_percentage"
               sorting="organism asc, tag_count desc"
             />
             <summary excludeProjects="TriTrypDB">
               Find SAGE Tags By Expression Level in a given library.
             </summary>
             <summary includeProjects="TriTrypDB">
               Find DGE Tags By Expression Level in a given library.
             </summary>
             <description includeProjects="PlasmoDB,EuPathDB,GiardiaDB">
         <![CDATA[
               <p>Find SAGE Tags By Expression Level in a given library.</p>  <p>See the related <a href="showQuestion.do?questionFullName=GeneQuestions.GenesBySageTag"><b>Genes by SAGE Tag Evidence</b></a> query for summing SAGE tag counts within predicted genes.
</p>
          ]]>
             </description>
             <description includeProjects="TriTrypDB">
         <![CDATA[
               <p>Find DGE Tags By Expression Level in a given library.</p>  <p>See the related <a href="showQuestion.do?questionFullName=GeneQuestions.GenesBySageTag"><b>Genes by DGE Tag Evidence</b></a> query for summing DGE tag counts within predicted genes.
</p>
          ]]>
             </description>
<description includeProjects="ToxoDB">
         <![CDATA[
               <p>Find SAGE Tags By Expression Level in a given library.</p>  <p>See the related <a href="showQuestion.do?questionFullName=GeneQuestions.GenesBySageTag"><b>Genes by SAGE Tag Evidence</b></a> query for summing SAGE tag counts within predicted genes.
</p>
The data available here is from a study conducted by <a href ="http://www.ncbi.nlm.nih.gov/pubmed/16324218">Radke et. al. </a> where SAGE tag libraries were generated from <i>T. gondii</i> parasites at specific stages of development.  The data available through ToxoDB includes 3' (3p) SAGE tag libraries only. Abbreviations are as follows:<br>
sp&nbsp;&nbsp;&nbsp;= Oocyst population that contains sporozoites (VEG strain).<br>
d4&nbsp;&nbsp;&nbsp;= Day 4 parasites (post-inoculation of human forskin fibroblast cells (HFFs)). <br>
d6&nbsp;&nbsp;&nbsp;= Day 6 parasites (post-inoculation of HFFs) -- rapidly growing in the second host cell. <br>
d7&nbsp;&nbsp;&nbsp;= Day 7 parasites (post-inoculation of HFFs) -- parasites undergo a growth shift at this point. <br>
d15&nbsp;= Day 15 parasites (post-inoculation of HFFs) -- The parasites are slow growing and include a mixture of tachyzoites and bradyzoites. <br>
ph&nbsp;&nbsp;&nbsp;= VEG parasites that were alkaline-differentiated into bradyzoites for 72 hours. <br>
rh&nbsp;&nbsp;&nbsp;&nbsp;= TypeI-RH. <br>
b7&nbsp;&nbsp;&nbsp;= TypeII-ME49B7. <br>
msj&nbsp;= TypeIII-VEGmsj. <br>
          ]]>
             </description>

           <dynamicAttributes includeProjects="PlasmoDB,ToxoDB,EuPathDB,GiardiaDB,TriTrypDB">
	     <columnAttribute name="tag_count" displayName="Normalized Tag Count" align="center"/>
	     <columnAttribute name="tag_percentage" displayName="Normalized Tag Percentage" align="center"/>
             <columnAttribute name="raw_count" displayName="Raw Tag Count" align="center"/>
	     <columnAttribute name="raw_percentage" displayName="RawTag Percentage" align="center"/>
             <columnAttribute name="SAGE_library" displayName="Experiment Name" align="center"/>
	</dynamicAttributes>

       <propertyList name="specificAttribution">
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagArrayDesign</value>
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagFreqs</value>
           <value includeProjects="EuPathDB,TriTrypDB">TrypSageTagFreqs</value>
           <value includeProjects="EuPathDB,ToxoDB">3primeToxoSageTags</value>
           <!-- <value includeProjects="EuPathDB,ToxoDB">5primeToxoSageTags</value> -->
           <!-- <value includeProjects="EuPathDB,ToxoDB">ToxoSageTagFreqs</value> -->
           <value includeProjects="EuPathDB,PlasmoDB">SageTagArrayDesign</value>
           <value includeProjects="EuPathDB,PlasmoDB">PlasmoSageTagFreqs</value>
       </propertyList>

    </question>

   <question name="SageTagByRadSourceId" 
              searchCategory="Other Attributes"
              displayName="SAGE Tag ID(s)"
              shortDisplayName="SAGE Tag IDs"
              queryRef="SageTagIds.ByRadSourceId" 
              recordClassRef="SageTagRecordClasses.SageTagRecordClass"
              noSummaryOnSingleRecord="true" 
              includeProjects="GiardiaDB,TriTrypDB,PlasmoDB,ToxoDB">

             <attributesList 
               summary="gene_source_id,gene_product,location_text,tag_sequence"
               sorting="organism asc"
             />
             <summary excludeProjects="TriTrypDB">
               Find SAGE Tags By Identifier
             </summary>
             <summary includeProjects="TriTrypDB">
               Find DGE Tags By Identifier
             </summary>
             <description excludeProjects="TriTrypDB">
               Find SAGE Tags By Identifier
             </description>
             <description includeProjects="TriTrypDB">
               Find DGE Tags By Identifier. The digital gene expression (DGE) tags represent a 21 bp tag usually from the first NlaIII restriction site upstream of the poly A tail on mRNA transcript. A detailed description of the method and experiment is available in Veitch et al ( Veitch NJ, Johnson PCD, Trivedi U, Terry S, Wildridge D and MacLeod A. Digital gene expression analysis of two life-cycle stages of the human-infective parasite, Trypanosoma brucei gambiense reveals differentially expressed clusters of co-regulated genes. BMC Genomics, 2010, 11:124-137). DGE tags were created from three procyclic-form  and three bloodstream-form Trypanosoma brucei gambiense STIB386 in vitro cultures. The 21bp tags have been aligned to the T.b.brucei 927 and T.b.gambiense Dal genome databases, allowing for up to a 2 bp  mismatch.  The differential expression of bloodstream-form versus procyclic-form T.b.gambiense DGE tags is available to view for each tag. All tags were mapped to the genome.  Tags that map to the forward strand are represented in Red. Tags that map to the reverse strand are represented in Blue. Tags that do not uniquely align to the genome (ie. map to more than one location) are represented in gray and on the negative axis.  
             </description>

   <propertyList name="specificAttribution">
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagArrayDesign</value>
           <value includeProjects="EuPathDB,GiardiaDB">GiardiaSageTagFreqs</value>
           <value includeProjects="EuPathDB,TriTrypDB">TrypSageTagFreqs</value>
           <value includeProjects="EuPathDB,ToxoDB">3primeToxoSageTags</value>
           <!-- <value includeProjects="EuPathDB,ToxoDB">5primeToxoSageTags</value> -->
           <!-- <value includeProjects="EuPathDB,ToxoDB">ToxoSageTagFreqs</value> -->
           <value includeProjects="EuPathDB,PlasmoDB">SageTagArrayDesign</value>
           <value includeProjects="EuPathDB,PlasmoDB">PlasmoSageTagFreqs</value>
       </propertyList>
    </question>


 <question name="SageTagByRadSourceId" 
              searchCategory="Other Attributes"
              displayName="ID"
              shortDisplayName="ID"
              queryRef="SageTagIds.ByRadSourceId" 
              recordClassRef="SageTagRecordClasses.SageTagRecordClass"
              includeProjects="EuPathDB">

             <attributesList 
               summary="gene_source_id,gene_product,location_text,tag_sequence"
               sorting="organism asc"
             />
             <summary excludeProjects="TriTrypDB">
               Find SAGE Tags in GiardiaDB, PlasmoDB and ToxoDB by ID
             </summary>
             <summary includeProjects="TriTrypDB">
               Find DGE Tags in TriTrypDB by ID
             </summary>
             <description excludeProjects="TriTrypDB">
               Find SAGE Tags in GiardiaDB, PlasmoDB and ToxoDB by ID.
             </description>
             <description includeProjects="TriTrypDB">
               Find DGE Tags in TriTrypDB by ID.
             </description>


      </question>


      <question name="SageTagesByWeightFilter"
              shortDisplayName="Weight"
              displayName="Filter by Weight"
              queryRef="SageTagIds.ByWeightFilter"
              recordClassRef="SageTagRecordClasses.SageTagRecordClass">
        <attributesList
           summary="wdk_weight"
        />
        <description>
           <![CDATA[
            Filter away results that have a weight outside the specified range.  
            (This transform is only useful if the input result sets have used weights)
          ]]>
        </description>
    </question>


  </questionSet>

</wdkModel>
