<wdkModel>

  <questionSet name="SnpQuestions" displayName="Search for SNPs" includeProjects="PlasmoDB,ToxoDB,CryptoDB,EuPathDB,AmoebaDB,TriTrypDB,FungiDB">

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- ID -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
     <question name="SnpBySourceId" includeProjects="PlasmoDB,ToxoDB,CryptoDB,AmoebaDB,TriTrypDB,FungiDB"
               displayName="SNP ID(s)"
               shortDisplayName="SNP ID(s)"
               queryRef="SnpsBy.SnpBySourceId"
	       recordClassRef="SnpRecordClasses.SnpRecordClass"
               noSummaryOnSingleRecord="true">

        <attributesList
              summary="snp_location,linkedGeneId,position_in_protein"
        />  

          <summary>
            Find SNPs by ID.
          </summary>
	 
	  <description>
	        <![CDATA[ 
              Find SNPs by SNP ID. Either enter the ID list manually, or upload a file that contains the list. 
             IDs can be delimited by a comma, a semi colon, or any white spaces. 
						 <br>
             <!-- See the Data Sets link below for experimental details.-->
            ]]> 
	  </description>

         <propertyList name="organism">
             <value includeProjects="PlasmoDB,EuPathDB">P. falciparum</value>
             <value includeProjects="ToxoDB,EuPathDB">T. gondii</value>
         </propertyList>
 
        <propertyList name="genomeAttribution">
          <value></value>
        </propertyList>
      </question>


      <question name="SnpBySourceId" includeProjects="EuPathDB"
               displayName="ID"
               shortDisplayName="ID"
               queryRef="SnpsBy.SnpBySourceId"
	       recordClassRef="SnpRecordClasses.SnpRecordClass"
               noSummaryOnSingleRecord="false">

        <attributesList
              summary="snp_location,linkedGeneId,position_in_protein"
        />  

          <summary>
            Find SNPs by ID
          </summary>

 <description>
        Find SNPs by ID. Either enter the ID list manually, 
           or upload a file that contains the list. IDs can be delimited by a comma, 
           a semi colon, or any white spaces. Also, the list may contain SNP IDs from any of the EuPathDB organisms in PlasmoDB, CryptoDB and ToxoDB.  For example, a list can be in the
           following form: "chr3-2_66329, CombinedSNP.MAL11.3000, SNP_Ia_17864"
      </description>


      </question>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Gene ID -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
      <question name="SnpsByGeneId" includeProjects="EuPathDB,PlasmoDB,ToxoDB,CryptoDB"
              searchCategory="Gene"
              displayName="Gene ID"
              shortDisplayName="Gene ID"
              queryRef="SnpsBy.SnpsByGeneId"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId, ref_strain,ref_allele,ref_product,comp_strains,comp_alleles,comp_products,position_in_protein,phenotype"
        />   

        <summary>
            Find SNPs that are located in a specified gene.
        </summary>

	<description includeProjects="PlasmoDB">
            <![CDATA[
              Find SNPs that are contained within a gene.
              SNP data was provided by <a href="getDataset.do?reference=SNPs&display=detail">Broad, NIH and WTSI</a>.
            ]]>
        </description>
	<description includeProjects="EuPathDB">
            <![CDATA[
              Find SNPs that are contained within a gene. <br>P.f. SNP data was provided by <a href="http://plasmodb.org/plasmo/getDataset.do?reference=SNPs&display=detail">Broad, NIH and WTSI</a>.<br> T.g. SNP data was provided by <a href="http://toxodb.org/toxo/getDataset.do?display=detail&datasets=tgonME49_SNP_Stanford_Tg10x_31_gff_RSRC,tgonME49_SNP_Amit_nucmer_gff_RSRC,tgonME49_SNP_Lindstrom_454_gff_RSRC,tgonME49_SNP_Sibley_Tg10x_31_gff_RSRC&title=SNPs%20Summary ">Boothroyd, Sibley, Roos, Bontell and Smith</a>.  <br>C.p. SNP data was provided by <a href="http://cryptodb.org/cryptodb/getDataset.do?display=detail&datasets=Widmer_SNPs&title=Query#Widmer_SNPs">Giovanni Widmer</a>.
            ]]>
        </description>
	<description includeProjects="ToxoDB">
            <![CDATA[
              Find SNPs between any two strains that are contained within a gene.
            ]]>
        </description>
	<description includeProjects="CryptoDB">
            <![CDATA[
              Find SNPs between any two strains that are contained within a gene. SNP data was provided by Giovanni Widmer. See the Data Sets link below for experimental details.
            ]]>
        </description>
        <dynamicAttributes>
	     <columnAttribute name="ref_strain" displayName="Like Reference" align="center" sortable="false" />
	     <columnAttribute name="comp_strains" displayName="SNP Strains" align="center" sortable="false" />
	     <columnAttribute name="ref_allele" displayName="Reference allele" align="center" sortable="false" />
	     <columnAttribute name="comp_alleles" displayName="SNP allele" align="center" sortable="false" />
	     <columnAttribute name="comp_products" displayName="SNP Product" align="center" sortable="false" />
	     <columnAttribute name="ref_product" displayName="Reference Product" align="center" sortable="false" />
	     <columnAttribute name="phenotype" displayName="Phenotype" align="center" sortable="false" />
	</dynamicAttributes>

         <propertyList name="organism">
             <value includeProjects="PlasmoDB,EuPathDB">P. falciparum</value>
             <value includeProjects="ToxoDB,EuPathDB">T. gondii</value>
             <value includeProjects="CryptoDB,EuPathDB">C. parvum</value>
         </propertyList>
 
        <propertyList name="genomeAttribution">
          <value includeProjects="PlasmoDB,EuPathDB">P.falciparum_chromosomes</value>
          <value includeProjects="ToxoDB,EuPathDB">ChromosomeMap</value>
          <value includeProjects="ToxoDB,EuPathDB">tgonME49_oldAnnotation_NAFeature_aliases_RSRC</value>
       </propertyList>
    </question>

      <question name="HtsSnpsByGeneId" includeProjects="EuPathDB,AmoebaDB,TriTrypDB,PlasmoDB,CryptoDB,FungiDB,ToxoDB"
              searchCategory="Gene"
              displayName="Gene ID (HTS)"
              shortDisplayName="Gene ID"
              queryRef="SnpsBy.HtsSnpsByGeneId"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId, ref_strain,ref_allele,ref_product,comp_strains,comp_alleles,comp_products,position_in_protein,phenotype"
        />   

        <summary>
            Find SNPs identified by HTS and sequence alignment that are located in a specified gene.
        </summary>



	<description includeProjects="PlasmoDB,ToxoDB">
            <![CDATA[
              Find SNPs that were generated by HTS sequencing and alignment of the resulting reads to reference genomes.  Note that the sequence reads may have been generated in a wide variety of laboratories all of which are included in this query.
<br/><br/>
<b>NOTE:</b>  Only snps w/ a read frequency of 80% or greater are considered.  (ie. for a SNP to be considered, 8 out of 10 reads must agree.)

            ]]>
        </description>

	<description excludeProjects="PlasmoDB,ToxoDB">
            <![CDATA[
              Find SNPs that were generated by HTS sequencing and alignment of the resulting reads to reference genomes.  Note that the sequence reads may have been generated in a wide variety of laboratories all of which are included in this query.
            ]]>
        </description>

        <dynamicAttributes>
	     <columnAttribute name="ref_strain" displayName="Like Reference" align="center" sortable="false" />
	     <columnAttribute name="comp_strains" displayName="SNP Strains" align="center" sortable="false" />
	     <columnAttribute name="ref_allele" displayName="Reference allele" align="center" sortable="false" />
	     <columnAttribute name="comp_alleles" displayName="SNP allele" align="center" sortable="false" />
	     <columnAttribute name="comp_products" displayName="SNP Product" align="center" sortable="false" />
	     <columnAttribute name="ref_product" displayName="Reference Product" align="center" sortable="false" />
	     <columnAttribute name="phenotype" displayName="Phenotype" align="center" sortable="false" />
	</dynamicAttributes>

         <propertyList name="organism">
             <value includeProjects="PlasmoDB,EuPathDB">P. falciparum</value>
             <value includeProjects="TriTrypDB,EuPathDB">T. brucei</value>
             <value includeProjects="AmoebaDB,EuPathDB">E. histolytica</value>
         </propertyList>
 
        <propertyList name="genomeAttribution">
          <value includeProjects="ToxoDB,EuPathDB">ChromosomeMap</value>
          <value includeProjects="ToxoDB,EuPathDB">tgonME49_oldAnnotation_NAFeature_aliases_RSRC</value>
       </propertyList>
    </question>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Location  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="SnpsByLocation" includeProjects="EuPathDB,PlasmoDB,ToxoDB,CryptoDB"
              searchCategory="Genomic Position"
              displayName="Genomic Location"
              shortDisplayName="Genomic Loc"
              queryRef="SnpsBy.SnpsByLocation"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId,ref_strain,ref_allele,ref_product,comp_strains,comp_alleles,comp_products,position_in_protein,phenotype"
        />
        <summary>
            <![CDATA[
            Find SNPs by chromosomal location
          ]]>
        </summary>

	<description includeProjects="PlasmoDB">
            <![CDATA[
              Find <i>P. falciparum</i> SNPs by chromosomal location.
              SNP data was provided by <a href="getDataset.do?reference=SNPs&display=detail">Broad, NIH and WTSI</a>.
            ]]>
        </description>
	<description includeProjects="ToxoDB">
            <![CDATA[
              Find SNPs between any two strains by chromosomal location.
            ]]>
        </description>
	<description includeProjects="EuPathDB">
            <![CDATA[
              Find SNPs by chromosomal location. <br>P.f. SNP data was provided by <a href="http://plasmodb.org/plasmo/getDataset.do?reference=SNPs&display=detail">Broad, NIH and WTSI</a>. <br> T.g. SNP data was provided by <a href="http://toxodb.org/toxo/getDataset.do?display=detail&datasets=tgonME49_SNP_Stanford_Tg10x_31_gff_RSRC,tgonME49_SNP_Amit_nucmer_gff_RSRC,tgonME49_SNP_Lindstrom_454_gff_RSRC,tgonME49_SNP_Sibley_Tg10x_31_gff_RSRC&title=SNPs%20Summary ">Boothroyd, Sibley, Roos, Bontell and Smith</a>.
            ]]>
        </description>
	<description includeProjects="CryptoDB">
            <![CDATA[
              Find SNPs by chromosomal location. SNP data was provided by Giovanni Widmer. See the Data Sets link below for experimental details.
            ]]>
        </description>
        <dynamicAttributes>
	     <columnAttribute name="ref_strain" displayName="Reference" align="center" sortable="false" />
	     <columnAttribute name="comp_strains" displayName="SNP Strains" align="center" sortable="false" />
	     <columnAttribute name="ref_allele" displayName="Reference allele" align="center" sortable="false" />
	     <columnAttribute name="comp_alleles" displayName="SNP allele" align="center" sortable="false" />
	     <columnAttribute name="comp_products" displayName="SNP Product" align="center" sortable="false" />
	     <columnAttribute name="ref_product" displayName="Reference Product" align="center" sortable="false" />
	     <columnAttribute name="phenotype" displayName="Phenotype" align="center" sortable="false" />
	</dynamicAttributes>
         <propertyList name="organism">
             <value includeProjects="PlasmoDB,EuPathDB">P. falciparum</value>
             <value includeProjects="ToxoDB,EuPathDB">T. gondii</value>
         </propertyList>
 
        <propertyList name="genomeAttribution">
          <value includeProjects="PlasmoDB,EuPathDB">P.falciparum_chromosomes</value>
          <value includeProjects="ToxoDB,EuPathDB">ChromosomeMap</value>
          <value includeProjects="ToxoDB,EuPathDB">tgonME49_oldAnnotation_NAFeature_aliases_RSRC</value>
       </propertyList>
    </question>

    <question name="HtsSnpsByLocation" includeProjects="EuPathDB,TriTrypDB,AmoebaDB,PlasmoDB,CryptoDB,ToxoDB,FungiDB"
              searchCategory="Genomic Position"
              displayName="Genomic Location (HTS)"
              shortDisplayName="Genomic Loc"
              queryRef="SnpsBy.HtsSnpsByLocation"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId,ref_strain,ref_allele,ref_product,comp_strains,comp_alleles,comp_products,position_in_protein,phenotype"
        />
        <summary>
            <![CDATA[
            Find HTS SNPs generated by highthroughput genomic sequencing by chromosomal location
          ]]>
        </summary>


	<description includeProjects="PlasmoDB,ToxoDB">
            <![CDATA[
              Find HTS SNPs by chromosomal location. SNPs are generated by aligning sequence reads against a reference organisms genome and called using SAMtools and VarScan. 
<br/><br/>
<b>NOTE:</b>  Only snps w/ a read frequency of 80% or greater are considered.  (ie. for a SNP to be considered, 8 out of 10 reads must agree.)

            ]]>
        </description>

	<description excludeProjects="PlasmoDB,ToxoDB">
            <![CDATA[
              Find HTS SNPs by chromosomal location. SNPs are generated by aligning sequence reads against a reference organisms genome and called using SAMtools and VarScan. 
            ]]>
        </description>
        <dynamicAttributes>
	     <columnAttribute name="ref_strain" displayName="Reference" align="center" sortable="false" />
	     <columnAttribute name="comp_strains" displayName="SNP Strains" align="center" sortable="false" />
	     <columnAttribute name="ref_allele" displayName="Reference allele" align="center" sortable="false" />
	     <columnAttribute name="comp_alleles" displayName="SNP allele" align="center" sortable="false" />
	     <columnAttribute name="comp_products" displayName="SNP Product" align="center" sortable="false" />
	     <columnAttribute name="ref_product" displayName="Reference Product" align="center" sortable="false" />
	     <columnAttribute name="phenotype" displayName="Phenotype" align="center" sortable="false" />
	</dynamicAttributes>
         <propertyList name="organism">
             <value includeProjects="PlasmoDB,EuPathDB">P. falciparum</value>
             <value includeProjects="ToxoDB,EuPathDB">T. gondii</value>
         </propertyList>
 
        <propertyList name="genomeAttribution">
          <value includeProjects="PlasmoDB,EuPathDB">P.falciparum_chromosomes</value>
          <value includeProjects="ToxoDB,EuPathDB">ChromosomeMap</value>
          <value includeProjects="ToxoDB,EuPathDB">tgonME49_oldAnnotation_NAFeature_aliases_RSRC</value>
       </propertyList>
    </question>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Strain  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="SnpsByStrain" includeProjects="EuPathDB,PlasmoDB,ToxoDB,CryptoDB"
              searchCategory="Strain"
              displayName="Strain"
              shortDisplayName="Strain"
              queryRef="SnpsBy.SnpsByStrain"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId,ref_strain,ref_allele,ref_product,comp_strains,comp_alleles,comp_products,position_in_protein,phenotype"
        />
        <summary>
            <![CDATA[
            Find SNPs by strains 
          ]]>
        </summary>

	<description includeProjects="PlasmoDB">
            <![CDATA[
              Find <i>P. falciparum</i> SNPs by strains.
              SNP data was provided by <a href="getDataset.do?reference=SNPs&display=detail">Broad, NIH and WTSI</a>.
            ]]>
        </description>
	<description includeProjects="ToxoDB">
            <![CDATA[
              Find SNPs by strains. 
            ]]>
        </description>
	<description includeProjects="EuPathDB">
            <![CDATA[
              Find SNPs by strains. <br>P.f. SNP data was provided by <a href="http://plasmodb.org/plasmo/getDataset.do?reference=SNPs&display=detail">Broad, NIH and WTSI</a>. <br> T.g. SNP data was provided by <a href="http://toxodb.org/toxo/getDataset.do?display=detail&datasets=tgonME49_SNP_Stanford_Tg10x_31_gff_RSRC,tgonME49_SNP_Amit_nucmer_gff_RSRC,tgonME49_SNP_Lindstrom_454_gff_RSRC,tgonME49_SNP_Sibley_Tg10x_31_gff_RSRC&title=SNPs%20Summary ">Boothroyd, Sibley, Roos, Bontell and Smith</a>.
            ]]>
        </description>
	<description includeProjects="CryptoDB">
            <![CDATA[
              Find SNPs by strains. SNP data was provided by Giovanni Widmer. See the Data Sets link below for experimental details.
            ]]>
        </description>
        <dynamicAttributes>
	     <columnAttribute name="ref_strain" displayName="Reference" align="center" sortable="false" />
	     <columnAttribute name="comp_strains" displayName="SNP Strains" align="center" sortable="false" />
	     <columnAttribute name="ref_allele" displayName="Reference allele" align="center" sortable="false" />
	     <columnAttribute name="comp_alleles" displayName="SNP allele" align="center" sortable="false" />
	     <columnAttribute name="comp_products" displayName="SNP Product" align="center" sortable="false" />
	     <columnAttribute name="ref_product" displayName="Reference Product" align="center" sortable="false" />
	     <columnAttribute name="phenotype" displayName="Phenotype" align="center" sortable="false" />
	</dynamicAttributes>
         <propertyList name="organism">
             <value includeProjects="PlasmoDB,EuPathDB">P. falciparum</value>
             <value includeProjects="ToxoDB,EuPathDB">T. gondii</value>
         </propertyList>
 
        <propertyList name="genomeAttribution">
          <value includeProjects="PlasmoDB,EuPathDB">P.falciparum_chromosomes</value>
          <value includeProjects="ToxoDB,EuPathDB">ChromosomeMap</value>
          <value includeProjects="ToxoDB,EuPathDB">tgonME49_oldAnnotation_NAFeature_aliases_RSRC</value>
       </propertyList>
    </question>

    <question name="HtsSnpsByStrain" includeProjects="EuPathDB,TriTrypDB,AmoebaDB,PlasmoDB,CryptoDB,ToxoDB,FungiDB"
              searchCategory="Strain"
              displayName="Strain (HTS)"
              shortDisplayName="Strain"
              queryRef="SnpsBy.HtsSnpsByStrain"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId,ref_strain,ref_allele,ref_product,comp_strains,comp_alleles,comp_products,position_in_protein,phenotype"
        />
        <summary>
            <![CDATA[
            Find HTS SNPs generated by highthroughput genomic sequencing by strain 
          ]]>
        </summary>

	<description includeProjects="PlasmoDB,ToxoDB">
            <![CDATA[
              Find HTS SNPs by strain. SNPs are generated by aligning sequence reads against a reference organisms genome and called using SAMtools and VarScan.
<br/><br/>
<b>NOTE:</b>  Only snps w/ a read frequency of 80% or greater are considered.  (ie. for a SNP to be considered, 8 out of 10 reads must agree.)
            ]]>
        </description>

	<description excludeProjects="PlasmoDB,ToxoDB">
            <![CDATA[
              Find HTS SNPs by strain. SNPs are generated by aligning sequence reads against a reference organisms genome and called using SAMtools and VarScan. 
            ]]>
        </description>

        <dynamicAttributes>
	     <columnAttribute name="ref_strain" displayName="Reference" align="center" sortable="false" />
	     <columnAttribute name="comp_strains" displayName="SNP Strains" align="center" sortable="false" />
	     <columnAttribute name="ref_allele" displayName="Reference allele" align="center" sortable="false" />
	     <columnAttribute name="comp_alleles" displayName="SNP allele" align="center" sortable="false" />
	     <columnAttribute name="comp_products" displayName="SNP Product" align="center" sortable="false" />
	     <columnAttribute name="ref_product" displayName="Reference Product" align="center" sortable="false" />
	     <columnAttribute name="phenotype" displayName="Phenotype" align="center" sortable="false" />
	</dynamicAttributes>
         <propertyList name="organism">
             <value includeProjects="PlasmoDB,EuPathDB">P. falciparum</value>
             <value includeProjects="ToxoDB,EuPathDB">T. gondii</value>
         </propertyList>
 
        <propertyList name="genomeAttribution">
          <value includeProjects="PlasmoDB,EuPathDB">P.falciparum_chromosomes</value>
          <value includeProjects="ToxoDB,EuPathDB">ChromosomeMap</value>
          <value includeProjects="ToxoDB,EuPathDB">tgonME49_oldAnnotation_NAFeature_aliases_RSRC</value>
       </propertyList>
    </question>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- One set of samples  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="SnpsByIsolatesGroup" includeProjects="PlasmoDB,ToxoDB,TriTrypDB" newBuild="20"
              searchCategory="Strain"
              displayName="Group of Isolates (HTS)"
              shortDisplayName="Isolate Grp"
              queryRef="SnpsBy.HtsSnpsByIsolateGroup"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId,position_in_protein, PercentMinorAlleles, PercentIsolateCalls, IsNonSynonymous"
        />
        <summary>
            <![CDATA[
            Find SNPs that have a specified level of minor alleles within a specified group of isolates.
          ]]>
        </summary>

        <description>
            <![CDATA[
            This search analyzes a group of isolates to find SNPs relative to the group.  Choose a group of isolates by specifying meta data that describes isolates you are interested in.  A SNP is returned for this group of isolates if it has a minor allele frequency that is greater or equal to the percent you specify.  The minor allele frequency is computed as the percent of <i>qualifying</i> alleles that are not the major allele. 
<p>
An allele for an isolate at a SNP location is qualifying if that allele has an above-threshold number of supporting reads at the SNP location.  The read frequency parameter controls this.  For example, if an isolate has 10 reads at a location, 6 A's and 4 C's, the allele will be called as an A and will qualify if you specify a read frequency of 60% or less.</p>
<p>A SNP is only considered if it has an above-threshold percent of alleles called.  For example, if you choose 20 isolates and a 'Min percent of isolates with calls' of 75%, then the SNP will be ignored if there are less than 15 isolates that have a qualifying allele.</p>
          ]]>
        </description>

        <dynamicAttributes>
	     <columnAttribute name="PercentMinorAlleles" displayName="% Minor Alleles" align="center" sortable="false" help="Percent of minor alleles for this group of isolates at this SNP location (where 'minor allele' means any allele that is not the major allele)."/>
	     <columnAttribute name="PercentIsolateCalls" displayName="% Calls" align="center" sortable="false" help="Percent of the isolates at this SNP location from the specified group that have read calls (over the threshold specified in the search)"/>
	     <columnAttribute name="IsNonSynonymous" displayName="Non Syn" align="center" sortable="false" help="1 = this SNP is within a gene and there is at least one sample in this set that has an allele with product that is non-synonomous with the most popular allele"/>
	</dynamicAttributes>
         <propertyList name="organism">
             <value includeProjects="PlasmoDB,EuPathDB">P. falciparum</value>
             <value includeProjects="ToxoDB,EuPathDB">T. gondii</value>
         </propertyList>
 
        <propertyList name="genomeAttribution">
          <value includeProjects="PlasmoDB,EuPathDB">P.falciparum_chromosomes</value>
          <value includeProjects="ToxoDB,EuPathDB">ChromosomeMap</value>
          <value includeProjects="ToxoDB,EuPathDB">tgonME49_oldAnnotation_NAFeature_aliases_RSRC</value>
       </propertyList>
    </question>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- HTS SNPs by Minor Allele Frequency -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="HTSSnpsByAlleleFrequency" includeProjects="EuPathDB,AmoebaDB,PlasmoDB,ToxoDB,TriTrypDB"
              searchCategory="Other Attributes"
              displayName="Allele Frequency (HTS)"
              shortDisplayName="Allele Freq (HTS)"
              queryRef="SnpsBy.HTSSnpsByAlleleFrequency"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList excludeProjects="PlasmoDB,ToxoDB"
              summary="snp_location,strain_count,major_allele_frequency,major_strains,major_allele,major_product,minor_allele_frequency,minor_strains,minor_allele,minor_product,linkedGeneId,position_in_protein"
        />
        <attributesList includeProjects="PlasmoDB,ToxoDB"
              summary="snp_location,strain_count,mjr_allele_frequency,mjr_allele,mjr_product,mnr_allele_frequency,mnr_allele,mnr_product,linkedGeneId,position_in_protein"
        />
        <summary>
            <![CDATA[
            Find HTS SNPs by the frequency of the minor allele
            ]]>
        </summary>



	<description includeProjects="PlasmoDB,ToxoDB">
            <![CDATA[
              Find HTS SNPs by specifying the frequency of the minor allele and number of strains sequenced at the SNP position.<p>
<br/><br/>
<b>NOTE:</b>  Only snps w/ a read frequency of 80% or greater are considered.  (ie. for a SNP to be considered, 8 out of 10 reads must agree.)

            ]]>
        </description>

	<description excludeProjects="PlasmoDB,ToxoDB">
            <![CDATA[
              Find HTS SNPs by specifying the frequency of the minor allele and number of strains sequenced at the SNP position.<p>
            ]]>
        </description>

        <dynamicAttributes>
	     <columnAttribute name="mjr_allele" displayName="Major Allele" align="center" includeProjects="PlasmoDB,ToxoDB" sortable="false" />
	     <columnAttribute name="mnr_allele" displayName="Minor Allele" align="center" includeProjects="PlasmoDB,ToxoDB" sortable="false" />
	     <columnAttribute name="mjr_product" displayName="Major Product" align="center" includeProjects="PlasmoDB,ToxoDB" sortable="false" />
	     <columnAttribute name="mnr_product" displayName="Minor Product" align="center" includeProjects="PlasmoDB,ToxoDB" sortable="false" />
	     <columnAttribute name="mjr_allele_frequency" displayName="Major Allele Frequency" align="center" includeProjects="PlasmoDB,ToxoDB" sortable="false" />
	     <columnAttribute name="mnr_allele_frequency" displayName="Minor Allele Frequency" align="center" includeProjects="PlasmoDB,ToxoDB" sortable="false" />
        </dynamicAttributes>

         <propertyList name="organism">
             <value includeProjects="PlasmoDB,EuPathDB">P. falciparum</value>
             <value includeProjects="ToxoDB,EuPathDB">T. gondii</value>
         </propertyList>


        <propertyList name="genomeAttribution">
          <value includeProjects="PlasmoDB,EuPathDB">P.falciparum_chromosomes</value>
          <value includeProjects="ToxoDB,EuPathDB">ChromosomeMap</value>
          <value includeProjects="ToxoDB,EuPathDB">tgonME49_oldAnnotation_NAFeature_aliases_RSRC</value>
       </propertyList>

    </question>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- isolate characteristics by dataset -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="SnpsByIsolatePattern" includeProjects="EuPathDB,PlasmoDB"
              searchCategory="Other Attributes"
              displayName="Isolate Comparison"
              shortDisplayName="Isolate Comp"
              queryRef="SnpsBy.SnpsByIsolatePattern"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,set_a_allele,set_a_count,set_b_allele,set_b_count,linkedGeneId"
        />
        <summary>
            <![CDATA[
              Find SNPs that distinguish two sets of isolates.
            ]]>
        </summary>

        <propertyList name="organism">
             <value>P. falciparum</value>
        </propertyList>

	<description>
            <![CDATA[
              Find SNPs that distinguish two sets of isolates.  Note that you can determine the specificity of the SNPs. For the most specific SNPs, you should make the number of isolates equal to the number of identifiers you are querying for in each set.   The default ids for Set A are the result of a query for isolates from Malawi (8 isolates) and Set B are the result of a query for isolates from Brazil (12 isolates).
            ]]>
        </description>
        <dynamicAttributes>
	     <columnAttribute name="set_a_allele" displayName="Set A allele" align="center" sortable="false" />
	     <columnAttribute name="set_b_allele" displayName="Set B allele" align="center" sortable="false" />
	     <columnAttribute name="set_a_count" displayName="Set A count" align="center" sortable="false" />
	     <columnAttribute name="set_b_count" displayName="Set B count" align="center" sortable="false" />
	</dynamicAttributes>


        <propertyList name="genomeAttribution">
          <value includeProjects="PlasmoDB,EuPathDB">P.falciparum_chromosomes</value>
       </propertyList>

    </question>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- hts snps by isolate comparison                 -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="HtsSnpsByIsolateComparison" includeProjects="EuPathDB,AmoebaDB,TriTrypDB,ToxoDB,PlasmoDB"
              searchCategory="Other Attributes"
              displayName="Isolate Comparison (HTS)"
              shortDisplayName="Isolate Comp"
              queryRef="SnpsBy.HtsSnpsByIsolateComparison"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,set_a_allele,set_a_count,set_b_allele,set_b_count,linkedGeneId"
              excludeProjects="PlasmoDB,ToxoDB"
        />
        <attributesList
              summary="snp_location,set_a_allele,set_a_percent,set_b_allele,set_b_percent,linkedGeneId"
              includeProjects="PlasmoDB,ToxoDB"
        />
        <summary>
            <![CDATA[
              Find SNPs that distinguish two sets of isolates.
            ]]>
        </summary>

        <propertyList name="organism">
             <value>T. brucei</value>
        </propertyList>


	<description includeProjects="PlasmoDB,ToxoDB">
            <![CDATA[
              Find SNPs that distinguish two sets of isolates. 
<br/><br/>
<b>NOTE:</b>  Only snps w/ a read frequency of 80% or greater are considered.  (ie. for a SNP to be considered, 8 out of 10 reads must agree.)
 
            ]]>
        </description>

	<description excludeProjects="PlasmoDB,ToxoDB">
            <![CDATA[
              Find SNPs that distinguish two sets of isolates.  
            ]]>
        </description>
        <dynamicAttributes>
	     <columnAttribute name="set_a_allele" displayName="Set A allele" align="center"/>
	     <columnAttribute name="set_b_allele" displayName="Set B allele" align="center"/>
	     <columnAttribute name="set_a_count" displayName="Set A count" align="center" excludeProjects="PlasmoDB,ToxoDB"/>
	     <columnAttribute name="set_b_count" displayName="Set B count" align="center" excludeProjects="PlasmoDB,ToxoDB"/>
	     <columnAttribute name="set_a_percent" displayName="Set A percent" align="center" includeProjects="PlasmoDB,ToxoDB"/>
	     <columnAttribute name="set_b_percent" displayName="Set B percent" align="center" includeProjects="PlasmoDB,ToxoDB"/>
	</dynamicAttributes>

    </question>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- isolate characteristics by history id -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
<!--
    <question name="SnpsByIsolatePatternHistory" includeProjects="EuPathDB,PlasmoDB"
              searchCategory="Other Attributes"
              displayName="Isolate Comparison using History IDs"
              queryRef="SnpsBy.SnpsByIsolatePatternHistory"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,set_a_allele,set_b_allele,linkedGeneId"
              sorting="snp_location asc"
        />
        <summary>
            <![CDATA[
              Find SNPs that distinguish two sets of isolates
            ]]>
        </summary>

        <propertyList name="organism">
             <value>P. falciparum</value>
        </propertyList>

	<description>
            <![CDATA[
              Find SNPs that distinguish two sets of isolates.  Note that you can determe the specificity of the SNPs. For the most specific SNPs, you should make the number of isolates equal to the number of identifiers you are querying for in each set.
            ]]>
        </description>
        <dynamicAttributes>
	     <columnAttribute name="set_a_allele" displayName="Set A allele" align="center"/>
	     <columnAttribute name="set_b_allele" displayName="Set B allele" align="center"/>
	</dynamicAttributes>


        <propertyList name="genomeAttribution">
          <value includeProjects="PlasmoDB,EuPathDB">P.falciparum_chromosomes</value>
       </propertyList>

    </question>
-->

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- that are isolates -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="SnpsByIsolateType" includeProjects="EuPathDB,PlasmoDB"
              searchCategory="Other Attributes"
              displayName="Presence in isolate assay"
              shortDisplayName="Isolate Assy"
              queryRef="SnpsBy.SnpsByIsolateType"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId,position_in_protein"
        />
        <summary>
            <![CDATA[
              Find SNPs that are being used for isolate typing.
            ]]>
        </summary>

        <propertyList name="organism">
             <value>P. falciparum</value>
        </propertyList>

	<description>
            <![CDATA[
              Find SNPs that are being used for isolate typing either in the barcoding assay or on the 3K SNP chip.
            ]]>
        </description>


        <propertyList name="genomeAttribution">
          <value includeProjects="PlasmoDB,EuPathDB">P.falciparum_chromosomes</value>
       </propertyList>

    </question>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- by isolate source_id                           -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="SnpsByIsolateId" includeProjects="PlasmoDB"
              searchCategory="Other Attributes"
              displayName="assayed in an isolate"
              shortDisplayName="Isolate ID"
              queryRef="SnpsBy.SnpsByIsolateId"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,is_source_id, isolate_allele,major_allele,minor_allele"
        />
        <summary>
            <![CDATA[
              Find SNPs that are present in a specific isolate.
            ]]>
        </summary>

        <propertyList name="organism">
             <value>P. falciparum</value>
        </propertyList>

	<description>
            <![CDATA[
              Find SNPs that were assayed for a specific isolate.
            ]]>
        </description>

         <dynamicAttributes> 
           <columnAttribute name="isolate_allele" displayName="Isolate allele" align="center" inReportMaker="true" sortable="false" /> 
           <columnAttribute name="is_source_id" displayName="Isolate ID" inReportMaker="true" sortable="false" /> 
         </dynamicAttributes>


        <propertyList name="genomeAttribution">
          <value includeProjects="PlasmoDB,EuPathDB">P.falciparum_chromosomes</value>
       </propertyList>

    </question>


    <question name="SnpsByWeightFilter"
              shortDisplayName="Weight"
              displayName="Filter by Weight"
              queryRef="SnpsBy.ByWeightFilter"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
           summary="wdk_weight"
        />
        <description>
           <![CDATA[
            Filter away results that have a weight outside the specified range.  
            (This transform is only useful if the input result sets have used weights)
          ]]>
        </description>
    </question>



  </questionSet>

  <questionSet name="InternalSnpQuestions"
             displayName="Internal Questions"
             internal="true">

      <question name="SnpsByGeneId" includeProjects="EuPathDB,ToxoDB,PlasmoDB,CryptoDB"
              searchCategory="Gene"
              displayName="Gene ID"
              shortDisplayName="Gene ID"
              queryRef="SnpsBy.DontCare"
              recordClassRef="SnpRecordClasses.SnpRecordClass">

        <summary>Find SNPs that are located in a specified gene.</summary>
	<description>INTERNAL</description>

        <propertyList name="websiteProperties">
            <value>hideOperation</value>
	     <value>hideAttrDescr</value>
        </propertyList>
    </question>

    <question name="SnpsByLocation" includeProjects="EuPathDB,ToxoDB,PlasmoDB,CryptoDB"
              searchCategory="Genomic Position"
              displayName="Genomic Location"
              shortDisplayName="Genomic Loc"
              queryRef="SnpsBy.DontCare"
              recordClassRef="SnpRecordClasses.SnpRecordClass">

        <summary>
            Find SNPs by chromosomal location
        </summary>

	<description>INTERNAL</description>

       <propertyList name="websiteProperties">
            <value>hideOperation</value>
	     <value>hideAttrDescr</value>
        </propertyList>
    </question>

    <question name="SnpsByStrain" includeProjects="EuPathDB,ToxoDB,PlasmoDB,CryptoDB"
              searchCategory="Strain"
              displayName="Strain"
              shortDisplayName="Stain"
              queryRef="SnpsBy.DontCare"
              recordClassRef="SnpRecordClasses.SnpRecordClass">

        <summary>
            Find SNPs by strain 
        </summary>

	<description>INTERNAL</description>

       <propertyList name="websiteProperties">
            <value>hideOperation</value>
	     <value>hideAttrDescr</value>
        </propertyList>
    </question>

    <question name="SnpsByIsolateComparison" includeProjects="EuPathDB,PlasmoDB"
              searchCategory="Isolate"
              displayName="Isolate Comparison"
              shortDisplayName="Isolate"
              queryRef="SnpsBy.DontCare"
              recordClassRef="SnpRecordClasses.SnpRecordClass">

        <summary>
            Find SNPs by Isolate Comparison 
        </summary>

	<description>INTERNAL</description>

       <propertyList name="websiteProperties">
            <value>hideOperation</value>
	     <value>hideAttrDescr</value>
        </propertyList>
    </question>


  </questionSet>

</wdkModel>
