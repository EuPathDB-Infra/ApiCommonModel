<wdkModel>

  <questionSet name="SnpQuestions" displayName="Search for SNPs" includeProjects="PlasmoDB,ToxoDB,CryptoDB,EuPathDB,AmoebaDB,TriTrypDB,FungiDB">

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- NGS SNP by SNP ID -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
     <question name="NgsSnpBySourceId" includeProjects="PlasmoDB,ToxoDB,CryptoDB,AmoebaDB,PiroplasmaDB,GiardiaDB,TriTrypDB,FungiDB"
               displayName="SNP ID(s)"
               shortDisplayName="SNP ID(s)"
               queryRef="SnpsBy.NgsSnpBySourceId"
	             recordClassRef="SnpRecordClasses.SnpRecordClass"
               noSummaryOnSingleRecord="true">

        <attributesList
              summary="snp_location,linkedGeneId,position_in_protein"
        />  

          <summary>
            Find SNPs by ID.
          </summary>
	 
	   <description>
	        <![CDATA[ 
              Find SNPs by SNP ID. <br><br>
              
              Either enter the ID list manually, or upload a file that contains the list. 
             IDs can be delimited by a comma, a semi colon, or any white spaces. 
						 <br>
             <!-- See the Data Sets link below for experimental details.-->
            ]]> 
	  </description>

      </question>


      <question name="NgsSnpBySourceId" includeProjects="EuPathDB"
               displayName="ID"
               shortDisplayName="ID"
               queryRef="SnpsBy.NgsSnpBySourceId"
	       recordClassRef="SnpRecordClasses.SnpRecordClass"
               noSummaryOnSingleRecord="false">

        <attributesList
              summary="snp_location,linkedGeneId,position_in_protein"
        />  

          <summary>
            Find SNPs by ID
          </summary>

 <description>
        Find SNPs by ID. Either enter the ID list manually, 
           or upload a file that contains the list. IDs can be delimited by a comma, 
           a semicolon, or any white spaces. The list may contain SNP IDs from 
           any of the EuPathDB organisms in PlasmoDB, CryptoDB and ToxoDB.  For 
           example, a list can be in the
           following form: "chr3-2_66329, NGS_SNP.Pf3D7_11_v3.1293957, SNP_Ia_17864"
      </description>


      </question>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- One set of isolates  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="NgsSnpsByIsolateGroup" includeProjects="PlasmoDB,ToxoDB,TriTrypDB,CryptoDB,PiroplasmaDB,GiardiaDB,AmoebaDB,FungiDB" newBuild="21"
              searchCategory="Strain"
              displayName="Differences Within a Group of Isolates"
              shortDisplayName="One Group"
              queryRef="SnpsBy.NgsSnpsByIsolateGroup"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId,position_in_protein, PercentMinorAlleles, PercentIsolateCalls, Phenotype"
        />
        <summary>
            <![CDATA[
            Find SNPs within a group of isolates with an option to specify minor allele frequency. 
          ]]>
        </summary>
<!-- 
        <description>
            <![CDATA[
            This search analyzes a group of isolates to find SNPs relative to the group.  
            Choose a group of isolates by specifying meta data that describes isolates 
            you are interested in.  A SNP is returned for this group of isolates if it 
            has a minor allele frequency that is greater or equal to the percent you 
            specify.  The minor allele frequency is computed as the percent of 
            <i>qualifying</i> alleles that are not the major allele. 
            <p>
            An allele for an isolate at a SNP location is qualifying if that allele has 
            an above-threshold number of supporting reads at the SNP location.  The read 
            frequency parameter controls this.  For example, if an isolate has 10 reads 
            at a location, 6 A's and 4 C's, the allele will be called as an A and will 
            qualify if you specify a read frequency of 60% or less.</p>
            
            <p>A SNP is only considered if it has an above-threshold percent of alleles 
            called.  For example, if you choose 20 isolates and a 'Min percent of isolates 
            with calls' of 75%, then the SNP will be ignored if there are less than 15 
            isolates that have a qualifying allele.</p>
          ]]>
        </description>
 -->
        <description>
            <![CDATA[
            This search analyzes whole genome sequencing data from a group of isolates to find SNPs
            associated with the group. <br><br>
            
            Each isolate's sequencing reads are aligned to the reference genome (Organism) and 
            SNPs are recorded for each isolate based on the Read Frequency Threshold. Then, 
            scanning SNP locations across the 
            group of isolates, SNPs are returned by the search if the Minor Allele Frequency and the 
            Percent Isolates with a base call are met. <br>
            <p> 
            <b>Organism:</b> Choosing an Organism. <br>
            The Organism parameter defines the species of the parasite isolates and the genome in which 
            the SNPs are determined.  Choosing an Organism focuses the Isolates parameter to the list of isolates 
            of that organism, thus changing the subset of isolates available when 
            forming your group. </p>

            <p>
            <b>Isolates:</b> Choosing the isolate group.<br>
            Isolate sequences are accompanied by information about the sequencing data set - metadata 
            such as the clinical phenotype of the host or the location collected. By default, the isolate group 
            includes all isolates from the Organism you chose. You have the option to limit the 
            group of isolates based on metadata characteristics. 
            For example, you can find SNPs for isolates collected from a certain geographic location. 
            To do this, click a metadata category (Country) on the left and choose your desired 
            metadata characteristic (e.g. Peru) on the right. Multiple metadata categories and characteristics 
            can be chosen when defining your group. Not all isolate data sets have the same 
            metadata. A running total of your selections is displayed above the 
            metadata filter.</p>
          
            
            <p>
            <b>Read Frequency Threshold:</b> Calling SNPs for each isolate in your group.<br>
            Each isolate's sequencing reads are aligned to a reference genome (Organism) and then each nucleotide position 
            with 5 or more aligned reads is examined. A base call is made if the aligned 
            reads meet your Read Frequency Threshold. For example, Isolate X has 10 aligned reads at 
            nucleotide position 1600. If 6 reads are G and 4 reads are A, the read frequency is 40%. Running this
            search with the Read Frequency Threshold set to 80% will prevent a base call and consequently 
            exclude Isolate X when returning SNPs for nucleotide position 1600. The parameter lets you 
            control the quality of the sequencing data and the confidence of the SNP calls.  Read 
            Frequency Threshold is a particularly important parameter when dealing with 
            diploid (or aneuploid) organisms since a read frequency of ~50% is expected for heterozygous SNPs. 
             </p>
             
            <img src="images/ReadFreq.jpg"  height="328px" width="500px" alt="Read Frequency Threshold">
            
            <p>
            <br>
            <br><b>The SNPs returned by this search are found by aligning the isolates (with SNPs 
            recorded as described above) and 
            applying 2 parameters across the group of isolates: Percent 
            isolates with a base call and Minor allele frequency.</b>
            <br>
            <br>
            
            <b>Percent isolates with a base call:</b> Parameter 1 for calling SNPs across your isolate group<br>
            Sometimes an isolate does not have a base 
            call at a certain nucleotide position because the Read Frequency Threshold was not met or because there
            were less than 5 aligned sequencing reads for that nucleotide position. In this case, a SNP can be 
            returned by the search based on a subset of your isolate group. The 'Percent isolates with a base call' 
            parameter defines the fraction of isolates that 
            must have a base call before a SNP is returned for that nucleotide position. The default setting 
            for this parameter is 80% or 8 out of 10 isolates in your group must have a base call for a SNP to be 
            returned by the search. </p>
            
            <p>
            <b>Minor allele frequency:</b> Parameter 2 for calling SNPs across your isolate group.<br>
            The minor allele frequency refers to the least common base call for a single nucleotide position across all isolates. 
            The default setting for this parameter is 0% and returns all SNPs - instances where at least one
            isolate has a base call that differs from reference. Increase the Minor allele frequency 
            to ensure that SNPs returned by the search are shared by two or more isolates in your group.</p>
            
            <img src="images/PIBC_MinorAllFreq.jpg"  height="263px" width="500px" alt="Percent Isolates with Base Call">
            
                           ]]>
        </description>     
        <dynamicAttributes>
	     <columnAttribute name="PercentMinorAlleles" displayName="% Minor Alleles" align="center" sortable="false" help="Percent of minor alleles for this group of isolates at this SNP location (where 'minor allele' means any allele that is not the major allele)."/>
	     <columnAttribute name="PercentIsolateCalls" displayName="% Calls" align="center" sortable="false" help="Percent of the isolates at this SNP location from the specified group that have read calls (over the threshold specified in the search)"/>
	     <columnAttribute name="Phenotype"  align="center" sortable="false" help="1 = this SNP is within a gene and there is at least one sample in this set that has an allele with product that is non-synonomous with the most popular allele"/>
	</dynamicAttributes>
 
    </question>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- By Genomic Location -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="NgsSnpsByLocation" includeProjects="PlasmoDB,ToxoDB,TriTrypDB,CryptoDB,PiroplasmaDB,GiardiaDB,AmoebaDB,FungiDB" newBuild="21"
              searchCategory="Strain"
              displayName="Genomic Location"
              shortDisplayName="Location"
              queryRef="SnpsBy.NgsSnpsByLocation"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId,position_in_protein, PercentMinorAlleles, PercentIsolateCalls, Phenotype"
        />
        <summary>
            <![CDATA[
            
            Find SNPs located in a specific genomic region that are associated with a group of isolates 
            with an option for specifying minor allele frequency. 
          
          ]]>
        </summary>
<!-- 
        <description>
            <![CDATA[

            This search analyzes a group of isolates to find SNPs relative to the group, and returns SNPs 
            found at a specified genomic location.  Choose a group of isolates by specifying meta data 
            that describes isolates you are interested in.  A SNP is returned for this group of isolates 
            if it has a minor allele frequency that is greater or equal to the percent you specify.  The 
            minor allele frequency is computed as the percent of <i>qualifying</i> alleles that are not 
            the major allele. 
            <p>
            An allele for an isolate at a SNP location is qualifying if that allele has an above-threshold 
            number of supporting reads at the SNP location.  The read frequency parameter controls this.  
            For example, if an isolate has 10 reads at a location, 6 A's and 4 C's, the allele will be 
            called as an A and will qualify if you specify a read frequency of 60% or less.
            </p>
            <p>A SNP is only considered if it has an above-threshold percent of alleles called.  For 
            example, if you choose 20 isolates and a 'Min percent of isolates with calls' of 75%, then 
            the SNP will be ignored if there are less than 15 isolates that have a qualifying allele.</p>

          ]]>
        </description>
 -->
         <description>
            <![CDATA[
            
            This search analyzes whole genome sequencing data from a group of isolates to find SNPs
            associated with the group and returns SNPs contained in your specified genomic location.<br><br>
            
             
            Each isolate's sequencing reads are aligned to the reference genome (Organism) and 
            SNPs are recorded for each isolate based on the Read Frequency Threshold. Then, 
            scanning SNP locations across the 
            group of isolates, SNPs  are returned by the search if they are contained 
            within your genomic location
            and if the Minor Allele Frequency and the 
            Percent Isolates with a base call are met. <br>
            
            <p> 
            <b>Organism:</b> Choosing an Organism. <br>
            The Organism parameter defines the species of the parasite isolates and the genome in which 
            the SNPs are determined.  Choosing an Organism focuses the Isolates parameter to 
            the list of isolates from that organism, thus changing the subset of isolates available when 
            forming your group. 
            </p>
            
            <p>
            <b>Defining the genomic location:</b><br>
            Chromosome Tab:<br>
            Choose the Chromosome that you want to query and then indicate the boundaries of the 
            genomic location by 
            entering the Start and End nucleotide coordinates of your region. Choosing Start=1 and End=0 
            will query for SNPs on the entire chromosome.<br>
            </p>
            <p>
            Sequence ID Tab:<br>
            First enter the Genomic Sequence ID of the contig or chromosome that you want to query. 
            Then indicate the boundaries of the genomic location by entering the Start and End 
            nucleotide coordinates of your region. Choosing Start=1 and End=0 will retrieve queryl for 
            SNPs on the entire contig or chromosome.<br>
            </p>
         
             <p>
            <b>Isolates:</b> Choosing the isolate group.<br>
            Isolate sequences are accompanied by information about the sequencing data set - metadata 
            such as the clinical phenotype of the host or the location collected. By default, the isolate group 
            includes all isolates from the Organism you chose. You have the option to limit the 
            group of isolates based on metadata characteristics. 
            For example, you can find SNPs for isolates collected from a certain geographic location. 
            To do this, click a metadata category (Country) on the left and choose your desired 
            metadata characteristic (e.g. Peru) on the right. Multiple metadata categories and characteristics 
            can be chosen when defining your group. Not all isolate data sets have the same 
            metadata. A running total of your selections is displayed above the 
            metadata filter.</p>
          
            
            <p>
            <b>Read Frequency Threshold:</b> Calling SNPs for each isolate in your group.<br>
            Each isolate's sequencing reads are aligned to a reference genome (Organism) and then each nucleotide position 
            with 5 or more aligned reads is examined. A base call is made if the aligned 
            reads meet your Read Frequency Threshold. For example, Isolate X has 10 aligned reads at 
            nucleotide position 1600. If 6 reads are G and 4 reads are A, the read frequency is 40%. Running this
            search with the Read Frequency Threshold set to 80% will prevent a base call and consequently 
            exclude Isolate X when returning SNPs for nucleotide position 1600. The parameter lets you 
            control the quality of the sequencing data and the confidence of the SNP calls.  Read 
            Frequency Threshold is a particularly important parameter when dealing with 
            diploid (or aneuploid) organisms since a read frequency of ~50% is expected for heterozygous SNPs. 
            </p>
            
            <img src="images/ReadFreq.jpg"  height="328px" width="500px" alt="Read Frequency Threshold">
            
            <p>

            <br>
            <br><b>The SNPs returned by this search are found by aligning the isolates (with SNPs 
            recorded as described above) and 
            applying 2 parameters across the group of isolates: Percent 
            isolates with a base call and Minor allele frequency.</b>
            <br>
            <br>
            
            
            <b>Percent isolates with a base call:</b> Parameter 1 for calling SNPs across your isolate group<br>
            Sometimes an isolate does not have a base 
            call at a certain nucleotide position because the Read Frequency Threshold was not met or because there
            were less than 5 aligned sequencing reads for that nucleotide position. In this case, a SNP can be 
            returned by the search based on a subset of your isolate group. The 'Percent isolates with a base call' 
            parameter defines the fraction of isolates that 
            must have a base call before a SNP is returned for that nucleotide position. The default setting 
            for this parameter is 80% or 8 out of 10 isolates in your group must have a base call for a SNP to be 
            returned by the search. </p>
            
            
            
            <p>
            <b>Minor allele frequency:</b> Parameter 2 for calling SNPs across your isolate group.<br>
            The minor allele frequency refers to the least common base call for a single nucleotide position across all isolates. 
            The default setting for this parameter is 0% and returns all SNPs - instances where at least one
            isolate has a base call that differs from reference. Increase the Minor allele frequency 
            to ensure that SNPs returned by the search are shared by two or more isolates in your group.</p>
            
            <img src="images/PIBC_MinorAllFreq.jpg"  height="263px" width="500px" alt="Percent Isolates with Base Call">
            
            
            
          ]]>
        </description>
 
        <dynamicAttributes>
	     <columnAttribute name="PercentMinorAlleles" displayName="% Minor Alleles" align="center" sortable="false" help="Percent of minor alleles for this group of isolates at this SNP location (where 'minor allele' means any allele that is not the major allele)."/>
	     <columnAttribute name="PercentIsolateCalls" displayName="% Calls" align="center" sortable="false" help="Percent of the isolates at this SNP location from the specified group that have read calls (over the threshold specified in the search)"/>
	     <columnAttribute name="Phenotype" align="center" sortable="false" help="1 = this SNP is within a gene and there is at least one sample in this set that has an allele with product that is non-synonomous with the most popular allele"/>
	</dynamicAttributes>
 
    </question>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- By Gene IDs                                    -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="NgsSnpsByGeneIds" includeProjects="PlasmoDB,ToxoDB,TriTrypDB,CryptoDB,PiroplasmaDB,GiardiaDB,AmoebaDB,FungiDB" newBuild="21"
              searchCategory="Strain"
              displayName="Gene IDs"
              shortDisplayName="Gene IDs"
              queryRef="SnpsBy.NgsSnpsByGeneIds"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId,position_in_protein, PercentMinorAlleles, PercentIsolateCalls, Phenotype"
        />
        <summary>
            <![CDATA[
            
            Find SNPs contained within a set of genes that are associated with a group of isolates 
            with an option for specifying minor allele frequency. 
          
          ]]>
        </summary>

<!--          <description>
            <![CDATA[
            This search analyzes a group of isolates to find SNPs relative to the group, and 
            returns SNPs found within a provided set of genes.  Choose a group of isolates 
            by specifying meta data that describes isolates you are interested in.  A SNP is 
            returned for this group of isolates if it has a minor allele frequency that is 
            greater or equal to the percent you specify.  The minor allele frequency is computed 
            as the percent of <i>qualifying</i> alleles that are not the major allele. 
            <p>
            An allele for an isolate at a SNP location is qualifying if that allele has an 
            above-threshold number of supporting reads at the SNP location.  The read frequency 
            parameter controls this.  For example, if an isolate has 10 reads at a location, 6 A's 
            and 4 C's, the allele will be called as an A and will qualify if you specify a read 
            frequency of 60% or less.</p>
            
            <p>A SNP is only considered if it has an above-threshold percent of alleles called.  
            For example, if you choose 20 isolates and a 'Min percent of isolates with calls' of 
            75%, then the SNP will be ignored if there are less than 15 isolates that have a 
            qualifying allele.</p>
                   ]]>
                    </description>
        
-->        

        <description>
            <![CDATA[

            This search analyzes whole genome sequencing data from a group of isolates to find SNPs
            associated with the group and returns SNPs contained within a set of genes that you specify.<br><br>
            
            Each isolate's sequencing reads are aligned to the reference genome (Organism) and 
            SNPs are recorded for each isolate based on the Read Frequency Threshold. 
            Then, scanning SNP locations across the 
            group of isolates, SNPs are returned by the search if they are contained within any gene in your list 
            and if the Minor Allele Frequency and the Percent Isolates with a base call are met. <br>
            <p> 
            <b>Organism:</b> Choosing an Organism. <br>
            The Organism parameter defines the species of the parasite isolates and the genome in which 
            the SNPs are determined.  Choosing an Organism focuses the Isolates parameter to the list of isolates 
            of that organism, thus changing the subset of isolates available when 
            forming your group. 
            
            <p>
            <b>Gene ID input set:</b> <br>
            SNPs returned by this search will be contained within any gene in you Gene ID input set.<br>
            Input a set of gene IDs, or upload a text file. IDs can be delimited 
            by a comma, semi colon, or any white space.<br><br>

            It is possible that not all IDs in the list will be found in the database due to annotation 
            changes or unavailable ID mapping. At present, we do not have a mechanism to inform you which 
            IDs from your input did not match anything in the database. 
            </p>
            
            <p>
            <b>Isolates:</b> Choosing the isolate group.<br>
            Isolate sequences are accompanied by information about the sequencing data set - metadata 
            such as the clinical phenotype of the host or the location collected. By default, the isolate group 
            includes all isolates from the Organism you chose. You have the option to limit the 
            group of isolates based on metadata characteristics. 
            For example, you can find SNPs for isolates collected from a certain geographic location. 
            To do this, click a metadata category (Country) on the left and choose your desired 
            metadata characteristic (e.g. Peru) on the right. Multiple metadata categories and characteristics 
            can be chosen when defining your group. Not all isolate data sets have the same 
            metadata. A running total of your selections is displayed above the 
            metadata filter.</p>
          
            
            <p>
            <b>Read Frequency Threshold:</b> Calling SNPs for each isolate in your group.<br>
            Each isolate's sequencing reads are aligned to a reference genome (Organism) and then each nucleotide position 
            with 5 or more aligned reads is examined. A base call is made if the aligned 
            reads meet your Read Frequency Threshold. For example, Isolate X has 10 aligned reads at 
            nucleotide position 1600. If 6 reads are G and 4 reads are A, the read frequency is 40%. Running this
            search with the Read Frequency Threshold set to 80% will prevent a base call and consequently 
            exclude Isolate X when returning SNPs for nucleotide position 1600. The parameter lets you 
            control the quality of the sequencing data and the confidence of the SNP calls.  Read 
            Frequency Threshold is a particularly important parameter when dealing with 
            diploid (or aneuploid) organisms since a read frequency of ~50% is expected for heterozygous SNPs. 
            
            </p>
            
            <img src="images/ReadFreq.jpg"  height="328px" width="500px" alt="Read Frequency Threshold">
            
            <p>
            
            <br>
            <br><b>The SNPs returned by this search are found by aligning the isolates (with SNPs 
            recorded as described above) and 
            applying 2 parameters across the group of isolates: Percent 
            isolates with a base call and Minor allele frequency.</b>
            <br>
            <br>
            
            
            <b>Percent isolates with a base call:</b> Parameter 1 for calling SNPs across your isolate group<br>
            Sometimes an isolate does not have a base 
            call at a certain nucleotide position because the Read Frequency Threshold was not met or because there
            were less than 5 aligned sequencing reads for that nucleotide position. In this case, a SNP can be 
            returned by the search based on a subset of your isolate group. The 'Percent isolates with a base call' 
            parameter defines the fraction of isolates that 
            must have a base call before a SNP is returned for that nucleotide position. The default setting 
            for this parameter is 80% or 8 out of 10 isolates in your group must have a base call for a SNP to be 
            returned by the search. </p>
            
            
            
            <p>
            <b>Minor allele frequency:</b> Parameter 2 for calling SNPs across your isolate group.<br>
            The minor allele frequency refers to the least common base call for a single nucleotide position across all isolates. 
            The default setting for this parameter is 0% and returns all SNPs - instances where at least one
            isolate has a base call that differs from reference. Increase the Minor allele frequency 
            to ensure that SNPs returned by the search are shared by two or more isolates in your group.</p>
            
            <img src="images/PIBC_MinorAllFreq.jpg"  height="263px" width="500px" alt="Percent Isolates with Base Call">
            



        ]]>
        </description>
        
        
        <dynamicAttributes>
	     <columnAttribute name="PercentMinorAlleles" displayName="% Minor Alleles" align="center" sortable="false" help="Percent of minor alleles for this group of isolates at this SNP location (where 'minor allele' means any allele that is not the major allele)."/>
	     <columnAttribute name="PercentIsolateCalls" displayName="% Calls" align="center" sortable="false" help="Percent of the isolates at this SNP location from the specified group that have read calls (over the threshold specified in the search)"/>
	     <columnAttribute name="Phenotype" align="center" sortable="false" help="1 = this SNP is within a gene and there is at least one sample in this set that has an allele with product that is non-synonomous with the most popular allele"/>
	</dynamicAttributes>
    </question>

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Two sets of isolates  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <question name="NgsSnpsByTwoIsolateGroups" includeProjects="PlasmoDB,ToxoDB,TriTrypDB,CryptoDB,PiroplasmaDB,GiardiaDB,AmoebaDB,FungiDB" newBuild="21"
              searchCategory="Strain"
              displayName="Differences Between Two Groups of Isolates"
              shortDisplayName="Two Groups"
              queryRef="SnpsBy.NgsSnpsByTwoIsolateGroups"
              recordClassRef="SnpRecordClasses.SnpRecordClass">
        <attributesList
              summary="snp_location,linkedGeneId,position_in_protein, MajorAlleleA, MajorAllelePctA, IsTriallelicA, MajorProductA, MajorProductIsVariableA, MajorAlleleB, MajorAllelePctB, IsTriallelicB, MajorProductB, MajorProductIsVariableB"
        />
        <summary>
            <![CDATA[
                Find SNPs that distinguish between two groups of isolates based on the user 
                supplied major allele threshold for each group.
          ]]>
        </summary>

<!-- 
        <description>
            <![CDATA[
                     
             This search allows you to identify SNPs that distinguish two groups of isolates.  
             In the most stringent criteria (100% major allele frequency), the SNP would always 
             enable you to determine to which group an unknown isolate may belong.  This seldom 
             happens unless the amount of data (numbers of isolates) are limiting.  Generally 
             one would want to identfy multiple SNPs that together would distinguish members of 
             the two groups.  By decreasing the major allele frequency you can return more SNPs 
             until you have an appropriate number.
             <p>The search finds the major allele among each group of isolates (note that there 
             may be no differences within the group, thus the major allele may be represented in 
             100% of the isolates in that group).  A SNP is returned if these major alleles are 
             different when compared between the two groups.
          ]]>
        </description>
 -->
 
         <description>
            <![CDATA[
 
            This search compares whole genome sequencing data from two group of isolates to find SNPs
            that differ between the two groups. 
            
            <p>
            Separately for isolate group A and B, each isolate's sequencing reads are 
            aligned to the reference genome (Organism) and 
            SNPs are recorded for each isolate based on the Read Frequency Threshold. Then, 
            scanning SNP locations across 
            group A and B separately, SNPs within each group are recorded if they meet the major allele frequency. 
            SNPs returned by the search are ones that differ between group A and B based on the major allele 
            frequency and percent isolates with a base call. </p>
            
            <p> 
            <b>Organism:</b> Choosing an Organism. <br>
            The Organism parameter defines the species of the parasite isolates and the genome in which 
            the SNPs are determined.  Choosing an Organism focuses the Isolates parameter to the list of isolates 
            of that organism, thus changing the subset of isolates available when 
            forming your group. </p>

            <p>
            <b>Isolates:</b> Choosing isolate group A and B.<br>
            Isolate sequences are accompanied by information about the sequencing data set - metadata 
            such as the clinical phenotype of the host or the location collected. By default, the isolate group 
            includes all isolates from the Organism you chose. You have the option to limit the 
            group of isolates based on metadata characteristics. 
            For example, you can find SNPs for isolates collected from a certain geographic location. 
            To do this, click a metadata category (Country) on the left and choose your desired 
            metadata characteristic (e.g. Peru) on the right. Multiple metadata categories and characteristics 
            can be chosen when defining your group. Not all isolate data sets have the same 
            metadata. A running total of your selections is displayed above the 
            metadata filter.</p>
          
            
            <p>
            <b>Read Frequency Threshold:</b> Calling SNPs for each isolate in a group.<br>
            Each isolate's sequencing reads are aligned to a reference genome (Organism) and then each nucleotide position 
            with 5 or more aligned reads is examined. A base call is made if the aligned 
            reads meet your Read Frequency Threshold. For example, Isolate X has 10 aligned reads at 
            nucleotide position 1600. If 6 reads are G and 4 reads are A, the read frequency is 40%. Running this
            search with the Read Frequency Threshold set to 80% will prevent a base call and consequently 
            exclude Isolate X when returning SNPs for nucleotide position 1600. The parameter lets you 
            control the quality of the sequencing data and the confidence of the SNP calls.  Read 
            Frequency Threshold is a particularly important parameter when dealing with 
            diploid (or aneuploid) organisms since a read frequency of ~50% is expected for heterozygous SNPs. 
             </p>
             
            <img src="images/ReadFreq.jpg"  height="328px" width="500px" alt="Read Frequency Threshold">
            
            <p>
            <br>
            <br><b>The SNPs returned by this search are found by aligning the isolates in each group (with SNPs 
            recorded as described above) and 
            applying 2 parameters across the group of isolates: Percent 
            isolates with a base call and Major allele frequency.</b>
            
            <p>
            <b>Major Allele Frequency:<b><br>
            
            
            <b>Percent isolates with a base call:</b> Parameter 1 for calling SNPs across your isolate group<br>
            Sometimes an isolate does not have a base 
            call at a certain nucleotide position because the Read Frequency Threshold was not met or because there
            were less than 5 aligned sequencing reads for that nucleotide position. In this case, a SNP can be 
            returned by the search based on a subset of your isolate group. The 'Percent isolates with a base call' 
            parameter defines the fraction of isolates that 
            must have a base call before a SNP is returned for that nucleotide position. The default setting 
            for this parameter is 80% or 8 out of 10 isolates in your group must have a base call for a SNP to be 
            returned by the search. </p>
            
            <p>
         
            
            <img src="images/PIBC_MinorAllFreq.jpg"  height="263px" width="500px" alt="Percent Isolates with Base Call">
            
                           ]]>
 

         </description>
        <dynamicAttributes>
	     <columnAttribute name="MajorAlleleA" displayName="Set A Major Allele" align="center" sortable="false" help=""/>
	     <columnAttribute name="MajorAllelePctA" displayName="Set A Major Allele Pct" align="center" sortable="false" help=""/>
	     <columnAttribute name="IsTriallelicA" displayName="Set A Is Triallelic" align="center" sortable="false" help=""/>
	     <columnAttribute name="MajorProductA" displayName="Set A Major Product" align="center" sortable="false" help=""/>
	     <columnAttribute name="MajorProductIsVariableA" displayName="Set A Mjr Prod Is Variable" align="center" sortable="false" help=""/>
	     <columnAttribute name="MajorAlleleB" displayName="Set B Major Allele" align="center" sortable="false" help=""/>
	     <columnAttribute name="MajorAllelePctB" displayName="Set B Major Allele Pct" align="center" sortable="false" help=""/>
	     <columnAttribute name="IsTriallelicB" displayName="Set B Is Triallelic" align="center" sortable="false" help=""/>
	     <columnAttribute name="MajorProductB" displayName="Set B Major Product" align="center" sortable="false" help=""/>
	     <columnAttribute name="MajorProductIsVariableB" displayName="Set B Mjr Prod Is Variable" align="center" sortable="false" help=""/>
	</dynamicAttributes>
    </question>

  </questionSet>

</wdkModel>
