<wdkModel>

  <!-- notes

    - why don't crypto and api have EstBySourceId query? apidb HAS it but not in the OLD model used for this. There is no reason why crypto could not have it.

    - why doesn't est by source id take a dataset? no reason

    - why does only byLocation have sorting attribute set? no reason

    - do we need organism properties for these (ie, which organisms we have ESTs for?) Cp,Pb,Pc,Pf,Pv,Py,Tg

    - why does crypto/api not have the dyn attrs for the gene overlap query? probably no reason, just it was not done.

  -->


  <questionSet name="EstQuestions" displayName="Search for ESTs" excludeProjects="HostDB">

  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!-- By Id -->
  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <question name="EstBySourceId"
	      displayName="EST Accession(s)"
	      shortDisplayName="EST Accessn."
	      queryRef="EstIds.EstBySourceId"
	      recordClassRef="EstRecordClasses.EstRecordClass"
              noSummaryOnSingleRecord="true" excludeProjects="EuPathDB">

        <attributesList
           summary="organism,dbest_name"
        />
        <summary>
	Find ESTs by ID
	</summary>

        <description>
           <![CDATA[
           Find ESTs by a list of IDs. Either enter the ID list manually, or upload a file that contains
           the list. IDs can be delimited by a comma, a semi colon, or any white spaces.
             ]]>
        </description>

       <propertyList name="genomeAttribution">
          <value/>
       </propertyList>

  </question>

  <question name="EstBySourceId"
	      displayName="ID"
	      shortDisplayName="ID"
	      queryRef="EstIds.EstBySourceId"
	      recordClassRef="EstRecordClasses.EstRecordClass"
              noSummaryOnSingleRecord="false" includeProjects="EuPathDB">

        <attributesList
           summary="organism,dbest_name"
        />
        <summary>
	Find ESTs by ID
	</summary>
 <description>
        Find ESTs by ID. Either enter the ID list manually, 
           or upload a file that contains the list. IDs can be delimited by a comma, 
           a semi colon, or any white spaces. Also, the list may contain IDs from any of the EuPathDB organisms.  For example, a list can be in the
           following form: "AA420947, EV500870, AU087658, AA009308, CV202103"
      </description>

  </question>

 <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!-- By Gene ID -->
  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <question name="ESTsByGeneIDs"
         displayName="Gene ID"
         shortDisplayName="Gene ID"
         queryRef="EstIds.ByGeneIDs"
         recordClassRef="EstRecordClasses.EstRecordClass"
	 includeProjects="EuPathDB,CryptoDB,ToxoDB,GiardiaDB,PlasmoDB,TriTrypDB,TrichDB,AmoebaDB,MicrosporidiaDB,FungiDB,SchistoDB,InitDB,PiroplasmaDB">


        <attributesList includeProjects="EuPathDB,ToxoDB,CryptoDB,GiardiaDB,TriTrypDB,AmoebaDB,MicrosporidiaDB,FungiDB,SchistoDB,InitDB,PiroplasmaDB"
           summary="organism,est_locations,genes, length"
           sorting="organism asc,est_locations asc"
        />
        <summary>Find ESTs by gene id(s).</summary>
        <description includeProjects="PlasmoDB,ToxoDB,GiardiaDB,TriTrypDB,TrichDB,AmoebaDB,MicrosporidiaDB,FungiDB,SchistoDB,InitDB,PiroplasmaDB,EuPathDB">Find ESTs by Gene ID(s).</description>

        <description includeProjects="CryptoDB">
       <![CDATA[
        Find ESTs by <i>C. parvum</i> Gene ID(s).
        ]]>
        </description>

        <dynamicAttributes includeProjects="EuPathDB,CryptoDB,ToxoDB,GiardiaDB,TriTrypDB,TrichDB,AmoebaDB,MicrosporidiaDB,FungiDB,SchistoDB,InitDB,PiroplasmaDB">
            <columnAttribute name="est_locations" displayName="EST location(s)"/>
            <columnAttribute name="genes" displayName="Gene(s)"/>
        </dynamicAttributes>

       <propertyList name="specificAttribution">
           <value includeProjects="TrichDB">dbEST</value>
       </propertyList>
    </question>


  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!-- BLAST Similarity -->
  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <question name="EstsBySimilarity"
         displayName="BLAST"
         shortDisplayName="BLAST"
         searchCategory="Similarity/Pattern"
         queryRef="EstIds.EstsBySimilarity"
         recordClassRef="EstRecordClasses.EstRecordClass"
         customJavascript="blast.js"
         fullAnswer="true">

        <attributesList
         summary="primary_key,organism,score,evalue"
         sorting="score desc"
        /> 

        <summary>
           Find ESTs that have BLAST similarity to your input sequence.
        </summary>

        <description>
           <![CDATA[
      As of 3 Feb 2014, this search uses NCBI-BLAST to determine sequence similarity. 
			Prior versions of the search used WU-BLAST.
		  <a target="_blank" href="http://www.ncbi.nlm.nih.gov/blast/Blast.cgi?CMD=Web&PAGE_TYPE=BlastDocs">NCBI-BLAST help.</a>
          ]]>
        </description>

         <summaryView name="blast-view" display="BLAST" default="true"
                      jsp="/wdkCustomization/jsp/results/blast-view.jsp"
                      handlerClass="org.eupathdb.common.model.view.BlastSummaryViewHandler" />

        <dynamicAttributes>
             <columnAttribute name="evalue_mant" internal="true" inReportMaker="false"/>             
             <columnAttribute name="evalue_exp" internal="true" inReportMaker="false"/>             
             <columnAttribute name="score" displayName="Score" />             
             <columnAttribute name="summary" displayName="Summary" internal="true" inReportMaker="false"/>             
             <columnAttribute name="alignment" displayName="Alignment" internal="true" inReportMaker="false"/>       
             <textAttribute name="evalue" displayName="E-Value">                
                <text>                   
                   <![CDATA[ $$evalue_mant$$E$$evalue_exp$$ ]]>                
                </text>             
             </textAttribute>
        </dynamicAttributes>
       <propertyList name="genomeAttribution">
          <value/>
       </propertyList>
       <propertyList name="specificAttribution">
           <value includeProjects="TrichDB">dbEST</value>
       </propertyList>
        <propertyList name="attribution">
           <value>dbEST</value>
        </propertyList>


	<propertyList name="websiteProperties">
            <value>hideTitle</value>
        </propertyList>

  </question>


  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!-- Location -->
  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <question name="EstsByLocation"
              searchCategory="Genomic Position"
              displayName="Genomic Location"
              shortDisplayName="Genomic Loc"
              queryRef="EstIds.EstsByLocation"
              recordClassRef="EstRecordClasses.EstRecordClass">

        <attributesList excludeProjects="ToxoDB,EuPathDB,GiardiaDB,TriTrypDB"
              summary="organism,dbest_name,est_location"
              sorting="organism asc, est_location asc"
        /> 
        <attributesList includeProjects="EuPathDB"
              summary="organism,dbest_name"
              sorting="organism asc, est_location asc"
        />
<!--
        <attributesList includeProjects="ToxoDB,GiardiaDB,TriTrypDB"
              summary="organism,dbest_name,est_location,assembly_link,assembly_est_count"
              sorting="organism asc, est_location asc"
        /> 
-->
        <attributesList includeProjects="ToxoDB,GiardiaDB,TriTrypDB"
              summary="organism,dbest_name,est_location"
              sorting="organism asc, est_location asc"
        /> 
        <dynamicAttributes>
            <columnAttribute name="est_location" displayName="EST location(s)"/>
        </dynamicAttributes>

        <summary>
            Find ESTs that are located in a specified genomic region.
        </summary>

	<description>
           <![CDATA[
          Find ESTs within a given genomic region.<br>
          The Start and End locations correspond to the coordinates of
          the EST(s) on the chromosome.
	   ]]>
	</description>

<!--
	<description includeProjects="AmoebaDB">
           <![CDATA[
          Find ESTs within a given genomic region.<br>
          Enter a genomic sequence ID for any <i>E. histolytica</i>, <i>E. dispar</i> or <i>E. invadens</i> contig.
          The Start and End locations correspond to the coordinates of
          the EST(s) on the chromosome.
<br /><br />EST's have been clustered/assembled into "DoTS Assemblies" which represent consensus sequences of overlapping EST's and mRNA's.  NOTE:  You can query for DoTS Assemblies directly by using the <a href="showQuestion.do?questionFullName=AssemblyQuestions.AssembliesByLocation">Assemblies by Location Query</a>.
	   ]]>
	</description>
	<description includeProjects="MicrosporidiaDB">
           <![CDATA[
          Find ESTs within a given genomic region.<br>
          Enter a genomic sequence ID for any <i>E. cuniculi</i> contig.
          The Start and End locations correspond to the coordinates of
          the EST(s) on the chromosome.
<br /><br />EST's have been clustered/assembled into "DoTS Assemblies" which represent consensus sequences of overlapping EST's and mRNA's.  NOTE:  You can query for DoTS Assemblies directly by using the <a href="showQuestion.do?questionFullName=AssemblyQuestions.AssembliesByLocation">Assemblies by Location Query</a>.
	   ]]>
	</description>
	<description includeProjects="CryptoDB">
           <![CDATA[
          Find ESTs within a given genomic region. The ESTs have not been mapped across species so be sure your genomic sequence ID and EST library choices are from the same species. For example, searching for <i>C. muris</i> ESTs on a <i>C. parvum</i> genomic sequence will return no results.<p>
          Select a <i>C. parvum</i> chromosome from the pull-down menu or
          enter the name of a contig for <i>C. muris</i> (e.g. 1104857754340),  <i>C. parvum</i> or <i>C. hominis</i> (e.g. AAEL01000057).
          If you enter both, your result will include the union.
          The Start and End locations correspond to the coordinates of the EST(s) on the chromosome.
          ]]>
        </description>
        <description includeProjects="PlasmoDB">
          <![CDATA[
          Find ESTs that are located in a specified genomic region.<br><br>
          Either select a <i>P. falciparum</i> genomic sequence from the
          pull-down menu <i>or</i> enter a genomic sequence ID from any
          <i>Plasmodium</i> species (if you supply both,  your result will include the union).
          The Start and End locations correspond to the coordinates of the EST(s) on the chromosome.
<br /><br />EST's have been clustered/assembled into "DoTS Assemblies" which represent consensus sequences of overlapping EST's and mRNA's.  NOTE:  You can query for DoTS Assemblies directly by using the <a href="showQuestion.do?questionFullName=AssemblyQuestions.AssembliesByLocation">Assemblies by Location Query</a>.
          ]]>
        </description>
        <description includeProjects="EuPathDB">
          <![CDATA[
          Find ESTs within a given genomic region.<br>
          Either select an organism and a genomic sequence from the
          pull-down menu or enter a genomic sequence ID from any EuPathDB
          species (e.g. "AAEL01000057", "MAL4", "Ia", "ctg02_305", "DS170425").
        
          The Start and End locations correspond to the coordinates of
          the EST(s) on the chromosome.
<br /><br />EST's have been clustered/assembled into "DoTS Assemblies" which represent consensus sequences of overlapping EST's and mRNA's.  NOTE:  You can query for DoTS Assemblies directly by using the <a href="showQuestion.do?questionFullName=AssemblyQuestions.AssembliesByLocation">Assemblies by Location Query</a>.
          ]]>
        </description>
        <description includeProjects="TrichDB">
          <![CDATA[
          Find ESTs within a given genomic region.<br>
          Enter a genomic sequence ID for any <i>T. vaginalis</I> contig.
          The Start and End locations correspond to the coordinates of
          the EST(s) on the chromosome.
<br /><br />EST's have been clustered/assembled into "DoTS Assemblies" which represent consensus sequences of overlapping EST's and mRNA's.  NOTE:  You can query for DoTS Assemblies directly by using the <a href="showQuestion.do?questionFullName=AssemblyQuestions.AssembliesByLocation">Assemblies by Location Query</a>.
          ]]>
        </description>
        <description includeProjects="GiardiaDB">
          <![CDATA[
          Find ESTs within a given genomic region.<br>
          Enter a genomic sequence ID for any <i>G. lamblia</I> contig.
          The Start and End locations correspond to the coordinates of
          the EST(s) on the sequence.
<br /><br />EST's have been clustered/assembled into "DoTS Assemblies" which represent consensus sequences of overlapping EST's and mRNA's.  NOTE:  You can query for DoTS Assemblies directly by using the <a href="showQuestion.do?questionFullName=AssemblyQuestions.AssembliesByLocation">Assemblies by Location Query</a>.
          ]]>
        </description>
        <description includeProjects="TriTrypDB">
          <![CDATA[
          Find ESTs that are located in a specified genomic region.<br><br>
          Either select an organism and chromosome from the pull-down menus <i>or</i> enter a genomic sequence ID 
          from any species (if you supply both,  your result will include the union). <br>
          The Start and End locations correspond to the coordinates of the EST(s) on the chromosome.
<br /><br />EST's have been clustered/assembled into "DoTS Assemblies" which represent consensus sequences of overlapping EST's and mRNA's.  NOTE:  You can query for DoTS Assemblies directly by using the <a href="showQuestion.do?questionFullName=AssemblyQuestions.AssembliesByLocation">Assemblies by Location Query</a>.
          ]]>
        </description>
        <description includeProjects="ToxoDB">
              <![CDATA[
          Find ESTs that are located in a specified genomic region.<br><br>
          Either select a <i>T. gondii</i> chromosome from the pull-down menu
          <b>or</b> enter a sequence ID of a chromosome (e.g. "VIIa") or a
          scaffold (e.g. "TGG_994746"). <br>
          If you enter both, your result will include the union.
          The Start and End locations correspond to the coordinates of the EST(s) on the chromosome.
<br /><br />EST's have been clustered/assembled into "DoTS Assemblies" which represent consensus sequences of overlapping EST's and mRNA's.  NOTE:  You can query for DoTS Assemblies directly by using the <a href="showQuestion.do?questionFullName=AssemblyQuestions.AssembliesByLocation">Assemblies by Location Query</a>.
          ]]>
        </description>
-->


       <propertyList name="specificAttribution">
           <value includeProjects="TrichDB">dbEST</value>
       </propertyList>
    </question>


  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!-- By Library -->
  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <question name="EstsByLibrary"
              searchCategory="Transcript Expression"
              displayName="Library"
              shortDisplayName="Library"
              queryRef="EstIds.EstsByLibrary"
              recordClassRef="EstRecordClasses.EstRecordClass">

        <summary>Find ESTs by Library Name</summary>
<!--
        <description excludeProjects="TrichDB,CryptoDB">
          <![CDATA[
Find ESTs by Library Name.  <br /><br />EST's have been clustered/assembled into "DoTS Assemblies" which represent consensus sequences of overlapping EST's and mRNA's.  NOTE:  You can query for DoTS Assemblies directly by using the <a href="showQuestion.do?questionFullName=AssemblyQuestions.AssembliesByLibrary">Assemblies by Library Query</a>.
          ]]>
        </description>

        <description includeProjects="TrichDB,CryptoDB">
          <![CDATA[
Find ESTs by Library Name. 
          ]]>
        </description>
-->
         <description>
          <![CDATA[
Find ESTs by Library Name. 
          ]]>
        </description>

        <attributesList excludeProjects="ToxoDB,GiardiaDB,TriTrypDB"
              summary="organism,dbest_name"
              sorting="organism asc"
        /> 
<!--
        <attributesList includeProjects="ToxoDB,GiardiaDB,TriTrypDB"
              summary="organism,dbest_name,assembly_link,assembly_est_count"
              sorting="organism asc,dbest_name asc,assembly_link asc,assembly_est_count desc"
        /> 
-->
         <attributesList includeProjects="ToxoDB,GiardiaDB,TriTrypDB"
              summary="organism,dbest_name"
              sorting="organism asc,dbest_name asc"
        /> 
       <propertyList name="genomeAttribution">
          <value/>
       </propertyList>
       <propertyList name="specificAttribution">
           <value includeProjects="TrichDB">dbEST</value>
       </propertyList>
  </question>


  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!-- With Gene Overlap -->
  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <question name="EstsWithGeneOverlap"
         displayName="Extent of Gene Overlap"
         shortDisplayName="Gene Overlap"
         queryRef="EstIds.EstsWithGeneOverlap"
         recordClassRef="EstRecordClasses.EstRecordClass">
<!--
        <attributesList excludeProjects="ToxoDB,EuPathDB,GiardiaDB,TriTrypDB"
           summary="organism,dbest_name,est_locations,genes"
           sorting="organism asc,est_locations asc"
        /> 
      
        <attributesList includeProjects="ToxoDB,GiardiaDB,TriTrypDB"
           summary="organism,dbest_name,est_locations,genes,assembly_link,assembly_est_count"
           sorting="organism asc,est_locations asc"
        /> 
-->
        <attributesList excludeProjects="EuPathDB"
           summary="organism,dbest_name,est_locations,genes"
           sorting="organism asc,est_locations asc"
        /> 

         <attributesList includeProjects="EuPathDB"
              summary="organism,dbest_name"
              sorting="organism asc"
        />

        <summary>Find ESTs in a Library that do or do not overlap with a gene.</summary>

<!--
        <description excludeProjects="CryptoDB">
          <![CDATA[ Find ESTs that Overlap a Gene.  <br /><br />EST's have been clustered/assembled into "DoTS Assemblies" which represent consensus sequences of overlapping EST's and mRNA's.  NOTE:  You can query for DoTS Assemblies directly by using the <a href="showQuestion.do?questionFullName=AssemblyQuestions.AssembliesWithGeneOverlap">Assemblies by Gene Overlap Query</a>.]]></description>

        <description includeProjects="CryptoDB">
          <![CDATA[ Find ESTs that Overlap a Gene.
	  ]]></description>
-->
         <description>
          <![CDATA[ Find ESTs that Overlap a Gene.
	  ]]></description>

        <dynamicAttributes excludeProjects="EuPathDB">
            <columnAttribute name="est_locations" displayName="EST location(s)"/>
            <columnAttribute name="genes" displayName="Gene(s)"/>
        </dynamicAttributes>

       <propertyList name="specificAttribution">
           <value includeProjects="TrichDB">dbEST</value>
       </propertyList>
    </question>


    <question name="EstsByWeightFilter"
              shortDisplayName="Weight"
              displayName="Filter by Weight"
              queryRef="EstIds.ByWeightFilter"
              recordClassRef="EstRecordClasses.EstRecordClass">
        <attributesList
           summary="wdk_weight"
        />
        <description>
           <![CDATA[
            Filter away results that have a weight outside the specified range.  
            (This transform is only useful if the input result sets have used weights)
          ]]>
        </description>
    </question>

  </questionSet>

</wdkModel>
