<wdkModel>

    <recordClassSet name="DynSpanRecordClasses">

        <recordClass name="DynSpanRecordClass" displayName="Genomic Segment" shortDisplayName="Segment"
          attributeOrdering="overview" doNotTest="true">

            <!-- primary key definition -->
            <primaryKeyAttribute name="primary_key"
                                 displayName="Segment ID">
                <columnRef>source_id</columnRef>
                <columnRef>project_id</columnRef>
                <text>
                    <![CDATA[
                      $$source_id$$
                    ]]>
                </text>                
            </primaryKeyAttribute>

      <!-- =============================================================== -->
      <!--   Reporters -->  
      <!-- =============================================================== -->

          <reporter name="tabular" displayName="Tab delimited (Excel): choose from columns"
                    implementation="org.gusdb.wdk.model.report.TabularReporter"/>
          <reporter name="fullRecord" displayName="Text: choose from columns and/or tables" excludeProjects="EuPathDB" 
                    implementation="org.gusdb.wdk.model.report.FullRecordReporter"/>
          <reporter name="xml" displayName="XML: choose from columns and/or tables" excludeProjects="EuPathDB" 
                    implementation="org.gusdb.wdk.model.report.XMLReporter" />
          <reporter name="json" displayName="json: choose from columns and/or tables" excludeProjects="EuPathDB" 
                    implementation="org.gusdb.wdk.model.report.JSONReporter" />
 


      <!-- =============================================================== -->
      <!--  Summary & record views -->
      <!-- =============================================================== -->

             <summaryView name="genomic-view" display="Genomic Locations"
                          jsp="/wdkCustomization/jsp/results/span-genome-view.jsp"
                          handlerClass="org.apidb.apicommon.model.view.genome.DynamicSpanGenomeViewHandler"/> 

       <!-- =================================================================== -->
       <!--  Attributes  ++++++++-->
       <!-- =================================================================== -->

          <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
          <!-- BFMV attributes -->  
          <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

        <attributeQueryRef ref="DynSpanAttributes.Bfmv">
            <columnAttribute name="project_id" internal="true" inReportMaker="false"/>
            <columnAttribute name="source_id" internal="true" inReportMaker="false"/>
            <columnAttribute name="seq_source_id"      displayName="Genomic Sequence ID"/>
            <columnAttribute name="start_min"      displayName="Start"/>
            <columnAttribute name="end_max"      displayName="End"/>
            <columnAttribute name="strand"      displayName="Strand"/>
            <columnAttribute name="length"      displayName="Length"/>
            <columnAttribute name="organism"    displayName="Organism" />
            <columnAttribute name="context_start"  internal="true" inReportMaker="false"/>
            <columnAttribute name="context_end"    internal="true" inReportMaker="false"/>
            <textAttribute name="location_text" displayName="Genomic Location" help="Contig/Chromosome:start-end(strand)">
             <display>
                  <![CDATA[
                  $$seq_source_id$$: $$start_min$$&nbsp;-&nbsp;$$end_max$$&nbsp;($$strand$$)
                  ]]>
              </display>
              <text>
                  <![CDATA[
                  $$seq_source_id$$: $$start_min$$ - $$end_max$$ ($$strand$$)
                  ]]>
              </text>
            </textAttribute>


        </attributeQueryRef>


<!--
        <attributeQueryRef ref="DynSpanAttributes.GeneCount">
            <columnAttribute name="geneCount"      displayName="Gene Count"/>
        </attributeQueryRef>

       <attributeQueryRef ref="DynSpanAttributes.OrfCount">
            <columnAttribute name="orfCount"      displayName="ORF Count"/>
        </attributeQueryRef>

        <attributeQueryRef ref="DynSpanAttributes.SnpCount">
            <columnAttribute name="snpCount"      displayName="SNP Count"/>
        </attributeQueryRef>

       <attributeQueryRef ref="DynSpanAttributes.SagetagCount">
            <columnAttribute name="sagetagCount"      displayName="Sage Tag Count"/>
        </attributeQueryRef>

         <attributeQueryRef ref="DynSpanAttributes.EstCount">
            <columnAttribute name="estCount"      displayName="EST Count"/>
        </attributeQueryRef>
-->

 
      <!-- =================================================================== -->
      <!--  Link Attributes  ++++++++-->
      <!-- =================================================================== -->


      <!-- =================================================================== -->
      <!--  Text Attributes  ++++++++-->
      <!-- =================================================================== -->

        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- overview -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
         <textAttribute name="overview" displayName="Overview"
                         inReportMaker="false" internal="true">
           <text>
              <![CDATA[ 
                  <table>
                    <tr><td width="30"><b>Organism:</b></td><td>$$organism$$</td></tr>
                    <tr><td width="30"><b>Sequence:</b></td><td>$$seq_source_id$$</td></tr>
                    <tr><td width="30"><b>Begin:</b></td><td>$$start_min$$ </td></tr>
                    <tr><td width="30"><b>End:</b></td><td>$$end_max$$ </td></tr>
                    <tr><td width="30"><b>Length:</b></td><td>$$length$$</td></tr>
                    <tr><td width="30"><b>Strand:</b></td><td>$$strand$$</td></tr>

                 </table>

              ]]>
           </text>

         </textAttribute>

 


        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- Other info -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
         <textAttribute name="otherInfo" includeProjects="ToxoDB,PlasmoDB,GiardiaDB,TrichDB,TriTrypDB,AmoebaDB,MicrosporidiaDB,FungiDB,HostDB,InitDB,PiroplasmaDB"
            displayName="Retrieve Sequence" inReportMaker="false" truncateTo='1500'>
           <text excludeProjects="ToxoDB">
                <![CDATA[
                    <!-- a href="@GENE_BY_CONTIG_URL@">Lookup Genes on this Contig</a><br -->
                    <form action="/cgi-bin/contigSrt" method="get">
                    <table border="0" cellpadding="5" cellspacing="1">
                      <tr class="secondary3"><td>
                        <table border="0" cellpadding="0">
                        <!-- tr><td colspan="2"><h3>Retrieve this sequence</h3></td></tr -->
                        <tr><td colspan="2"><b>Nucleotide positions:</b>&nbsp;&nbsp;
                                <input name='project_id' value=@PROJECT_ID@ size='20' type='hidden' />
                                <input name='ids' value='$$seq_source_id$$' size='20' type='hidden' />
                                <input type="text" name="start" value='$$start_min$$' maxlength="7" size="8"/>
                             to <input type="text" name="end" value='$$end_max$$' maxlength="7" size="8"/>
                        &nbsp;&nbsp;&nbsp;&nbsp;<br>
                        <input type="checkbox" name="revComp">Reverse & Complement</td></tr>
                           <tr><td align="left"><input type="submit" name='go' value='Get Sequence' /></td></tr>
                    </table>
                    </td></tr></table>
                    </form>
                ]]>
           </text>
           <text includeProjects="ToxoDB">
                <![CDATA[
                    <!-- a href="@GENE_BY_CONTIG_URL@">Lookup Genes on this Contig</a><br -->
                    <form action="/cgi-bin/contigSrt" method="get">
                    <table border="0" cellpadding="5" cellspacing="1">
                      <tr class="secondary3"><td>
                        <table border="0" cellpadding="0">
                        <tr><td colspan="2"><b>Nucleotide positions:</b>&nbsp;&nbsp;
                                <input name='project_id' value=@PROJECT_ID@ size='20' type='hidden' />
                                <input name='ids' value='$$seq_source_id$$' size='20' type='hidden' />
                                <input type="text" name="start" value='$$start_min$$' maxlength="7" size="8"/>
                             to <input type="text" name="end" value='$$end_max$$' maxlength="7" size="8"/>
                        &nbsp;&nbsp;&nbsp;&nbsp;<br>
                       <input type="checkbox" name="revComp">Reverse & Complement</td></tr>
                           <tr><td align="left"><input type="submit" name='go' value='Get Sequence' /></td></tr>
                    </table>
                    </td></tr></table>
                    </form>
                ]]>
           </text>
        </textAttribute>


      <!-- ======================================================================================================== -->
      <!-- Tables: features that overlap (includes containment) the selected dynamic span/ genomic region   ++++++++-->
      <!-- ======================================================================================================== -->


         <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- genes -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

        <table name="Genes"
               displayName="Genes"
               queryRef="DynSpanTables.Genes">
            <columnAttribute name="gene_source_id" displayName="Gene ID" internal="true"/>
            <linkAttribute displayName="Gene ID" name="geneIdLink" inReportMaker="false">
                 <displayText>$$gene_source_id$$</displayText>
                   <url>
             <![CDATA[showRecord.do?name=GeneRecordClasses.GeneRecordClass&project_id=@PROJECT_ID@&source_id=$$gene_source_id$$]]>
                   </url>
            </linkAttribute>
            <columnAttribute name="start_min" displayName="Start"/>
            <columnAttribute name="end_max" displayName="End"/>  
            <columnAttribute name="strand" displayName="Strand"/>
            <columnAttribute name="product" displayName="Product Description"/>
        </table>


         <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- ORFs -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

        <table name="ORFs"
               displayName="ORFs"
               queryRef="DynSpanTables.ORFs">
            <columnAttribute name="orf_source_id" displayName="ORF ID" internal="true"/>
            <linkAttribute displayName="ORF ID" name="orfIdLink" inReportMaker="false">
                 <displayText>$$orf_source_id$$</displayText>
                   <url>
             <![CDATA[showRecord.do?name=OrfRecordClasses.OrfRecordClass&project_id=@PROJECT_ID@&source_id=$$orf_source_id$$]]>
                   </url>
            </linkAttribute>
            <columnAttribute name="start_min" displayName="Start"/>
            <columnAttribute name="end_max" displayName="End"/>  
            <columnAttribute name="length" displayName="Length"/>  
             <columnAttribute name="is_reversed" displayName="Is reversed?"/>

        </table>



        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- SNPs -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

        <table name="SNPs"
               displayName="SNPs"
               queryRef="DynSpanTables.SNPs">
            <columnAttribute name="snp_source_id" displayName="SNP ID" internal="true"/>
            <linkAttribute displayName="SNP ID" name="snpIdLink" inReportMaker="false">
                 <displayText>$$snp_source_id$$</displayText>
                   <url>
             <![CDATA[showRecord.do?name=SnpRecordClasses.SnpRecordClass&primary_key=$$snp_source_id$$]]>
                   </url>
            </linkAttribute>
            <columnAttribute name="start_min" displayName="Position"/>
            <columnAttribute name="reference_strain" displayName="Reference strain"/>
            <columnAttribute name="reference_na" displayName="Reference_allele"/>
             <columnAttribute name="gene_source_id" displayName="Gene ID"/>
             <columnAttribute name="gene_strand" displayName="Gene strand"/>
             <columnAttribute name="is_coding" displayName="Is coding?"/>
 <columnAttribute name="strain_count" displayName="Strain Count"/>

        </table>
  


       <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- sage tag alignments -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

        <table name="SageTags"
               displayName="Sage Tag Alignments"
               queryRef="DynSpanTables.SageTags">
            <columnAttribute name="stag_source_id" displayName="Sage Tag alignment ID" internal="true"/>
            <linkAttribute displayName="Sage Tag alignment ID" name="stagIdLink" inReportMaker="false">
                 <displayText>$$stag_source_id$$</displayText>
                   <url>
             <![CDATA[showRecord.do?name=SageTagRecordClasses.SageTagRecordClass&project_id=@PROJECT_ID@&source_id=$$stag_source_id$$]]>
                   </url>
            </linkAttribute>
            <columnAttribute name="start_min" displayName="Start"/>
            <columnAttribute name="end_max" displayName="End"/>  
            <columnAttribute name="is_reversed" displayName="Is reversed?"/>
            <columnAttribute name="sequence" displayName="Sequence"/>
            <columnAttribute name="gene_count" displayName="Gene Count"/>
 
        </table>
  

        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- EST alignments -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

        <table name="ESTs"
               displayName="EST Alignments"
               queryRef="DynSpanTables.ESTs">
            <columnAttribute name="est_source_id" displayName="EST alignment ID" internal="true"/>
            <linkAttribute displayName="EST ID" name="estIdLink" inReportMaker="false">
                 <displayText>$$est_source_id$$</displayText>
                   <url>
             <![CDATA[showRecord.do?name=EstRecordClasses.EstRecordClass&project_id=@PROJECT_ID@&source_id=$$est_source_id$$]]>
                   </url>
            </linkAttribute>
            <columnAttribute name="target_start" displayName="Start"/>
            <columnAttribute name="target_end" displayName="End"/>  
            <columnAttribute name="length" displayName="Length"/>
            <columnAttribute name="is_reversed" displayName="Is reversed?"/>
            <columnAttribute name="is_best_alignment" displayName="Is best alignment?"/>
            <columnAttribute name="is_consistent" displayName="Is consistent?"/>
            <columnAttribute name="percent_identity" displayName="% Identity"/>
          
            <columnAttribute name="gene" displayName="Gene ID"/>

           <!--  <columnAttribute name="assembly_source_id" displayName="Assembly ID"/>
            <columnAttribute name="assembly_est_count" displayName="Assembly EST count"/> -->
 
        </table>


       </recordClass>
    </recordClassSet>
</wdkModel>
