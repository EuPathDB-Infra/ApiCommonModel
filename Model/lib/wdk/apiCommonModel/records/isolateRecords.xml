<wdkModel>
    <recordClassSet name="IsolateRecordClasses">

      <recordClass name="IsolateRecordClass" urlName="isolate" displayName="Isolate"> 

          <recordOverview>
            <![CDATA[
            <div class="eupathdb-RecordOverview">
	      <div class="eupathdb-RecordOverviewLeft">
                <div class="eupathdb-RecordOverviewItem" data-label="Strain">$$strain$$</div>
                <div class="eupathdb-RecordOverviewItem" data-label="Host">$$host_linkout$$</div>
                <div class="eupathdb-RecordOverviewItem" data-label="Isolation Source">$$isolation_source$$</div>
                <div class="eupathdb-RecordOverviewItem" data-label="Curated Isolation Source">$$curated_isolation_source$$</div>
		<div class="eupathdb-RecordOverviewItem" data-label="Geographic Location">$$geographic_location$$</div>
		<div class="eupathdb-RecordOverviewItem" data-label="Country">$$country$$</div>
		<div class="eupathdb-RecordOverviewItem" data-label="Curated country">$$curated_country$$</div>
	      </div>
              <div class="eupathdb-RecordOverviewRight">
                <div class="eupathdb-RecordOverviewItem" data-label="Organism">$$organism$$</div>
		<div class="eupathdb-RecordOverviewItem" data-label="Product">$$product$$</div>
		<div class="eupathdb-RecordOverviewItem" data-label="Description">$$description$$</div>
		<div class="eupathdb-RecordOverviewItem" data-label="Note">$$note$$</div>
              </div>
            </div>
            ]]>
          </recordOverview>

      <testParamValues includeProjects="AmoebaDB">
         <paramValue name="source_id">GQ423750</paramValue>
      </testParamValues>

      <testParamValues includeProjects="CryptoDB">
         <paramValue name="source_id">AY168847</paramValue>
      </testParamValues>

      <testParamValues includeProjects="GiardiaDB,EuPathDB">
         <paramValue name="source_id">AF176672</paramValue>
      </testParamValues>

      <testParamValues includeProjects="MicrosporidiaDB">
         <paramValue name="source_id">AB472273</paramValue>
      </testParamValues>

      <testParamValues includeProjects="PiroplasmaDB">
         <paramValue name="source_id">EU362993</paramValue>
      </testParamValues>

      <testParamValues includeProjects="PlasmoDB">
         <paramValue name="source_id">FJ490884</paramValue>
      </testParamValues>

      <testParamValues includeProjects="ToxoDB">
         <paramValue name="source_id">AB703307</paramValue>
      </testParamValues>

      <testParamValues includeProjects="FungiDB">
         <paramValue name="source_id">GQ247676</paramValue>
         <paramValue name="project_id">FungiDB</paramValue>
      </testParamValues>



      <!-- primary key definition -->
      <primaryKeyAttribute name="primary_key"
                           displayName="Isolate Id">
        <columnRef>source_id</columnRef>
        <columnRef>project_id</columnRef>
        <text>
          <![CDATA[
            $$source_id$$
          ]]>
        </text>
      </primaryKeyAttribute>


      <attributesList summary="organism, strain, specific_host, geographic_location, isolation_source"/>

      <!-- ======================== -->
      <!--  Summary & record views  -->
      <!-- ======================== -->

      <summaryView name="_default" display="Isolates"
                   jsp="/wdkCustomization/jsp/results/isolate-default-view.jsp"/>

      <summaryView name="isolate-view" display="Isolate Geographical Location"
                   jsp="/wdkCustomization/jsp/results/isolate-geographical-view.jsp"
                   handlerClass="org.apidb.apicommon.model.view.GeoIsolateViewHandler"/>

      <!-- =========== -->
      <!--  Reporters  -->
      <!-- =========== -->

      <reporter name="tabular" displayName="Tab delimited (Excel): choose from columns"
                implementation="org.gusdb.wdk.model.report.TabularReporter">
        <property name="page_size">500</property>
      </reporter>

         <reporter name="tableColumnar" displayName="Tab delimited (Excel)"
                    implementation="org.gusdb.wdk.model.report.TableColumnarReporter">
             <property name="page_size">500</property>
          </reporter>

         <reporter name="attributesColumnar" displayName="Tab delimited (Excel)"
                    implementation="org.gusdb.wdk.model.report.AttributesColumnarReporter">
             <property name="page_size">500</property>
          </reporter>

      <reporter name="fullRecord" displayName="Text: choose from columns and/or tables" excludeProjects="EuPathDB" 
                implementation="org.gusdb.wdk.model.report.FullRecordReporter" />

      <reporter name="xml" displayName="XML: choose from columns and/or tables" 
                implementation="org.gusdb.wdk.model.report.XMLReporter" />
      <reporter name="json" displayName="json: choose from columns and/or tables" 
                implementation="org.gusdb.wdk.model.report.JSONReporter" />

      <!-- the report maker used on commandline to generate detailed download files -->
      <reporter name="fullRecordDump" displayName="Detailed - text" 
                inReportMaker="false"
                implementation="org.gusdb.wdk.model.report.FullRecordReporter">
        <property name="table_cache">apidb.WdkIsolateTable</property>
        <property name="record_id_column">source_id</property>
      </reporter>

      <!-- =========== -->
      <!--   Filters   -->
      <!-- =========== -->


      <answerFilterLayout name="eupath_project" visible="true"
                            fileName="eupath_project_filter.jsp" 
                            displayName="Filter results by component website" includeProjects="EuPathDB">
        <instanceRef ref="all_results" />
        <instanceRef ref="amoeba_isolates" />
        <instanceRef ref="crypto_isolates" />
        <instanceRef ref="fungi_isolates" />
        <instanceRef ref="giardia_isolates" />
        <instanceRef ref="micro_isolates" />
        <instanceRef ref="piro_isolates" />
        <instanceRef ref="plasmo_isolates" />
        <instanceRef ref="toxo_isolates" />
        <instanceRef ref="trich_isolates" />
        <instanceRef ref="tritryp_isolates" />
      </answerFilterLayout>

      <answerFilter queryRef="IsolateTables.AllResults"   includeProjects="EuPathDB">
        <instance name="all_results" displayName="All Results" default="true">
          <description>
            <![CDATA[
              All results
            ]]>
          </description>
        </instance>
      </answerFilter>

      <answerFilter queryRef="IsolateTables.ApiProjectIsolates"
                    includeProjects="EuPathDB">
        <instance name="crypto_isolates" displayName="CryptoDB" >
          <description>
            <![CDATA[
              Number of Isolates in CryptoDB
            ]]>
          </description>
          <paramValue name="Project">CryptoDB</paramValue>
        </instance>
        <instance name="giardia_isolates" displayName="GiardiaDB" >
          <description>
            <![CDATA[
              Number of Isolates in GiardiaDB
            ]]>
          </description>
          <paramValue name="Project">GiardiaDB</paramValue>
        </instance>
        <instance name="plasmo_isolates" displayName="PlasmoDB" >
          <description>
            <![CDATA[
              Number of Isolates in PlasmoDB
            ]]>
          </description>
          <paramValue name="Project">PlasmoDB</paramValue>
        </instance>
        <instance name="toxo_isolates" displayName="ToxoDB" >
          <description>
            <![CDATA[
              Number of Isolates in ToxoDB
            ]]>
          </description>
          <paramValue name="Project">ToxoDB</paramValue>
        </instance>
        <instance name="trich_isolates" displayName="TrichDB" >
          <description>
            <![CDATA[
              Number of Isolates in TrichDB
            ]]>
          </description>
          <paramValue name="Project">TrichDB</paramValue>
        </instance>
        <instance name="tritryp_isolates" displayName="TriTrypDB" >
          <description>
            <![CDATA[
              Number of Isolates in TriTrypDB
            ]]>
          </description>
          <paramValue name="Project">TriTrypDB</paramValue>
        </instance>
        <instance name="amoeba_isolates" displayName="AmoebaDB" >
          <description>
            <![CDATA[
              Number of Isolates in AmoebaDB
            ]]>
          </description>
          <paramValue name="Project">AmoebaDB</paramValue>
        </instance>
        <instance name="micro_isolates" displayName="MicrosporidiaDB" >
          <description>
            <![CDATA[
              Number of Isolates in MicrosporidiaDB
            ]]>
          </description>
          <paramValue name="Project">MicrosporidiaDB</paramValue>
        </instance>
        <instance name="piro_isolates" displayName="PiroplasmaDB" >
          <description>
            <![CDATA[
              Number of Isolates in PiroplasmaDB
            ]]>
          </description>
          <paramValue name="Project">PiroplasmaDB</paramValue>
        </instance>
        <instance name="fungi_isolates" displayName="FungiDB" >
          <description>
            <![CDATA[
              Number of Isolates in FungiDB
            ]]>
          </description>
          <paramValue name="Project">FungiDB</paramValue>
        </instance>
      </answerFilter>
     

      <!-- ============== -->
      <!--   Attributes   -->
      <!-- ============== -->

      <!--+++++++++++++++++++++-->
      <!-- sequence attributes -->
      <!--+++++++++++++++++++++-->

      <attributeQueryRef ref="IsolateAttributes.Attributes">
        <columnAttribute name="source_id" internal="true" inReportMaker="false"/>
        <columnAttribute name="organism" displayName="Organism" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>

        <columnAttribute name="strain" displayName="Strain/Isolate Name" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>

        <columnAttribute name="specific_host" displayName="Host" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>
        <columnAttribute name="host_ncbi_tax_id" displayName="Host Taxon ID" internal="false"/>
        <textAttribute inReportMaker="false" internal="true" name="host_linkout" excludeProjects="EuPathDB">
          <text>
            <![CDATA[<a href="http://www.ncbi.nlm.nih.gov/taxonomy/?term=$$host_ncbi_tax_id$$" target=_blank>$$specific_host$$</a>]]>
          </text>
        </textAttribute>



        <columnAttribute name="isolation_source" displayName="Isolation Source" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>

        <columnAttribute name="geographic_location" displayName="Geographic Location" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>

        <columnAttribute name="country" displayName="Country" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>

        <columnAttribute name="curated_country" displayName="Country" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>

<!--
        <columnAttribute name="annotated_specific_host" displayName="EuPathDB Annotated Host" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>
-->
        <columnAttribute name="curated_isolation_source" displayName="EuPathDB Annotated Isolation Source" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>

  <!--      <columnAttribute name="annotated_geographic_location" displayName="EuPathDB Annotated Geographic Location" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>
-->

        <columnAttribute name="product" displayName="Gene Product (Sequence Typed Only)" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>

        <columnAttribute name="description" displayName="Description" internal="false">
          <plugin name="wordCloud" display="Word Cloud"
                  description="Display the terms in the attribute as word clouds"
                  implementation="org.gusdb.wdk.model.record.attribute.plugin.WordCloudAttributePlugin"
                  view="/wdk/jsp/results/wordCloud.jsp" />
        </columnAttribute>

        <columnAttribute name="note" displayName="Note" internal="true"/>
        <columnAttribute name="is_reference" displayName="Is Reference" internal="false" includeProjects="CryptoDB"/>
        <columnAttribute name="external_db_name" displayName="External DB Name" internal="true"/>
        <columnAttribute name="external_db_version" displayName="External DB Version" internal="true"/>

        <textAttribute inReportMaker="false" internal="true" name="linkout" excludeProjects="EuPathDB">
          <text>
            <![CDATA[<a href="http://www.ncbi.nlm.nih.gov/entrez/viewer.fcgi?db=nuccore&id=$$source_id$$" target=_blank>NCBI</a>]]>
          </text>
        </textAttribute>

      </attributeQueryRef>


      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
      <!-- Isolate DNA Sequence attributes -->
      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

      <attributeQueryRef ref="IsolateAttributes.NucleicAcidSequence">
        <columnAttribute name="sequence" displayName="DNA Sequence" internal="true"/>
        <columnAttribute name="sequence_length" displayName="Sequence Length"/>
      </attributeQueryRef>


     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- Isolates Publication table -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

     <table name="Reference"  displayName="Reference" queryRef="IsolateTables.Reference" 
	    excludeProjects="EuPathDB">
        <columnAttribute internal="true" name="title"/>
        <columnAttribute internal="true" name="authors"/>
        <columnAttribute internal="true" name="journal"/>
        <textAttribute inReportMaker="true" name="reference" displayName="Reference">
             <text>
              <![CDATA[
                   $$authors$$  <u>$$title$$</u>.  $$journal$$
                    ]]>
                  </text>
            </textAttribute>
        <columnAttribute displayName="All Other Isolates in this Study"  name="studyLink"/>

     </table>

     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- Gene Overlap -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

     <table name="GeneOverlap" 
            displayName="Blast Similarity Alignments and Overlapping Genes" queryRef="IsolateTables.GeneOverlap">
        <columnAttribute name="source_id" internal="true"/>
        <columnAttribute  name="gene" internal="true" displayName="Overlapping Gene"/>
        <columnAttribute  name="pvalue_mant" internal="true"/>
        <columnAttribute  name="pvalue_exp" internal="true"/>
        <columnAttribute  name="start_min" internal="true"/>
        <columnAttribute  name="end_max" internal="true"/>
        <columnAttribute  name="sequence_source_id" internal="true" displayName="Genomic Sequence"/>

        <columnAttribute  displayName="Organism" name="organism" internal="false"/>

        <linkAttribute displayName="Genomic Sequence" name="sequence_link" inReportMaker="false" internal="false" >
           <displayText>
            <![CDATA[ $$sequence_source_id$$  ]]>
           </displayText>
           <url>
            <![CDATA[                       
              showRecord.do?name=SequenceRecordClasses.SequenceRecordClass&source_id=$$sequence_source_id$$
              ]]>
            </url>
        </linkAttribute>

        <linkAttribute displayName="Genome Browser" name="gbrowse_link" inReportMaker="false" internal="false" excludeProjects="EuPathDB" >
           <displayText>
            <![CDATA[ view  ]]>
           </displayText>
           <url>
<!--
              /cgi-bin/gbrowse/$$lc_project_id$$/?name=$$sequence_source_id$$%3A$$start_min$$-$$end_max$$;enable=Gene-IsolatePopset;h_feat=$$sequence_source_id$$@thistle
-->
            <![CDATA[                       
              /cgi-bin/gbrowse/plasmodb/?name=$$sequence_source_id$$%3A$$start_min$$-$$end_max$$;enable=Gene-IsolatePopset;h_feat=$$sequence_source_id$$@thistle
              ]]>
            </url>
        </linkAttribute>
        <linkAttribute displayName="Overlapping Gene" name="gene_link" inReportMaker="false" internal="false" >
           <displayText>
            <![CDATA[ $$gene$$  ]]>
           </displayText>
           <url>
            <![CDATA[                       
              showRecord.do?name=TranscriptRecordClasses.TranscriptRecordClass&source_id=$$gene$$
              ]]>
            </url>
        </linkAttribute>
        <columnAttribute  displayName="Gene Product" name="gene_product" internal="false"/>
     </table>

     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- RFLP genotype -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

<!--
     <table name="RFLPgenotype" includeProjects="ToxoDB"
            displayName="RFLP Genotype"
            queryRef="IsolateTables.RFLPgenotype">
        <columnAttribute name="source_id" internal="true"/>
        <columnAttribute name="genotype" displayName="Genotype #"/>
     </table>
-->

     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- RFLP data -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

<!--
     <table name="RFLPdata" includeProjects="ToxoDB"
            displayName="RFLP data"
            queryRef="IsolateTables.RFLPdata">
        <columnAttribute name="source_id" internal="true"/>
        <columnAttribute name="locus" internal="false" displayName="Locus"/>
        <columnAttribute name="type" displayName="Type" internal="false"/>
     </table>
-->


     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- User Comments table -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <table name="IsolateComments"
            displayName="User Comments"
            queryRef="CommentTables.IsolateComments">
        <columnAttribute name="comment_id" internal="true" displayName="Comment ID"/>
 <propertyList name="excludeFromDumper"><value>true</value></propertyList>
        <linkAttribute name="comment_id_link" inReportMaker="false"
              displayName="Comment ID">
                 <displayText>
                    <![CDATA[
                    $$comment_id$$
                    ]]>
                 </displayText>
          <url>
            <![CDATA[showComment.do?projectId=@PROJECT_ID@&stableId=$$stable_id$$&commentTargetId=$$comment_target_id$$#$$comment_id$$]]>
          </url>
        </linkAttribute>
        <columnAttribute name="stable_id" internal="true"/>
        <columnAttribute name="comment_target_id" internal="true"/>
        <columnAttribute name="headline" displayName="Headline"/>
        <columnAttribute name="pmids" internal="true" displayName="PubMed ID(s)"/>
        <linkAttribute name="pmids_link" inReportMaker="false"
                     displayName="PubMed ID(s)">
          <displayText>
            <![CDATA[
              $$pmids$$
            ]]>
          </displayText>
          <url>
            <![CDATA[/cgi-bin/pmid2title?pmids=$$pmids$$]]>
          </url>
        </linkAttribute>
        <columnAttribute name="genecount" displayName="# Related Genes"/>
        <columnAttribute name="filecount" displayName="# Uploaded Files"/>
        <columnAttribute name="user_name_org" displayName="Made by"/>
        <columnAttribute name="comment_date" displayName="Date"/>
     </table>

     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- Protein Sequence -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

<!--
     <table name="ProteinSequence" excludeProjects="EuPathDB" 
            displayName="Protein Sequence"
            queryRef="IsolateTables.ProteinSequence">
        <columnAttribute name="protein_sequence" internal="true"/>
     </table>
-->


     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- Trivial attribute tables to feed text search  -->
     <!--  these should go away
            when fullRecordDump starts including attributes -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

     <table name="organism" displayName="Organism" queryRef="IsolateTables.organism">
        <columnAttribute name="organism" internal="true"/>
     </table>

     <table name="description" displayName="Description" queryRef="IsolateTables.description">
        <columnAttribute name="description" internal="true"/>
     </table>

     <table name="product" displayName="Product" queryRef="IsolateTables.product">
        <columnAttribute name="product" internal="true"/>
     </table>

     <table name="strain" displayName="Strain/Isolate Name" queryRef="IsolateTables.strain">
        <columnAttribute name="strain" internal="true"/>
     </table>

     <table name="host" displayName="Host" queryRef="IsolateTables.host">
        <columnAttribute name="host" internal="true"/>
     </table>

     <table name="note" displayName="Note" queryRef="IsolateTables.note">
        <columnAttribute name="note" internal="true"/>
     </table>

     <table name="isolation_source" displayName="Isolation Source" queryRef="IsolateTables.isolation_source">
        <columnAttribute name="isolation_source" internal="true"/>
     </table>

     <table name="geographic_location" displayName="Geographic Location" queryRef="IsolateTables.geographic_location">
        <columnAttribute name="geographic_location" internal="true"/>
     </table>


     </recordClass>


  </recordClassSet>


</wdkModel>
