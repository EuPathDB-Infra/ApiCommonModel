<wdkModel>
    <querySet name="IsolateAttributes" queryType="attribute" includeProjects="CryptoDB,GiardiaDB,MicrosporidiaDB,PiroplasmaDB,PlasmoDB,ToxoDB,EuPathDB">
    
      <defaultTestParamValues includeProjects="CryptoDB">
         <paramValue name="source_id">AY168847</paramValue>
         <paramValue name="project_id">CryptoDB</paramValue>
      </defaultTestParamValues>

      <defaultTestParamValues includeProjects="GiardiaDB,EuPathDB">
         <paramValue name="source_id">AF176672</paramValue>
         <paramValue name="project_id">GiardiaDB</paramValue>
      </defaultTestParamValues>

      <defaultTestParamValues includeProjects="MicrosporidiaDB">
         <paramValue name="source_id">AB472273</paramValue>
         <paramValue name="project_id">MicrosporidiaDB</paramValue>
      </defaultTestParamValues>

      <defaultTestParamValues includeProjects="PiroplasmaDB">
         <paramValue name="source_id">EU362993</paramValue>
         <paramValue name="project_id">PiroplasmaDB</paramValue>
      </defaultTestParamValues>

      <defaultTestParamValues includeProjects="PlasmoDB">
         <paramValue name="source_id">FJ490884</paramValue>
         <paramValue name="project_id">PlasmoDB</paramValue>
      </defaultTestParamValues>

      <defaultTestParamValues includeProjects="ToxoDB">
         <paramValue name="source_id">EF639858</paramValue>
         <paramValue name="project_id">ToxoDB</paramValue>
      </defaultTestParamValues>


      <testRowCountSql excludeProjects="EuPathDB">
           select count(*) from ApidbTuning.IsolateAttributes 
      </testRowCountSql>

       <testRowCountSql includeProjects="EuPathDB">
	 SELECT count(*) FROM ApidbTuning.IsolateAttributes
       </testRowCountSql>

       <sqlQuery name="Attributes">
            <column name="project_id"/>
            <column name="lc_project_id"/>
            <column name="source_id"/> 
            <column name="organism" /> 
            <column name="strain" /> 
            <column name="specific_host" /> 
            <column name="description"/> 
            <column name="isolation_source" /> 
            <column name="geographic_location"/> 
            <column name="data_type"/> 
            <column name="note"/> 
            <column name="is_reference"/> 
            <column name="external_db_name"/> 
            <column name="external_db_version"/> 
            <column name="product"/> 
            <column name="annotated_isolation_source"/> 
            <column name="annotated_specific_host"/> 
            <column name="annotated_geographic_location"/> 
            <sql>
               SELECT iso.source_id, 
                      iso.project_id, 
                      lower(iso.project_id) as lc_project_id, 
                      iso.organism,
                      iso.strain,
                      iso.specific_host,
                      iso.isolation_source,
                      iso.description,
                      iso.geographic_location,
                      iso.note,
                      decode(iso.is_reference, 0, 'No', 1, 'Yes', 'No') is_reference,
                      iso.data_type,
                      iso.external_db_name,
                      iso.external_db_version,
                      iso.product,
                      iso.annotated_isolation_source,
                      iso.annotated_specific_host,
                      iso.annotated_geographic_location
                FROM   ApidbTuning.IsolateAttributes iso
           </sql>
      </sqlQuery>

        <sqlQuery name="LinkOut">
            <column name="source_id" />
            <column name="project_id" />
            <column name="linkout" />
            <sql>
            <![CDATA[
            SELECT source_id, '@PROJECT_ID@' as project_id,
            CASE WHEN data_type='Sequencing Typed' THEN 
               '<a href="http://www.ncbi.nlm.nih.gov/entrez/viewer.fcgi?db=nuccore&' || 'id=' || source_id || '" target=_blank>NCBI</a>'
             ELSE 'None'
            END as linkout
            FROM   ApidbTuning.IsolateAttributes
            ]]>
            </sql>
        </sqlQuery>


      <sqlQuery name="NucleicAcidSequence">
            <column name="project_id"/>
            <column name="source_id"/> 
            <column name="sequence"/>
            <sql>
           select i.source_id, i.project_id as project_id,
                  s.sequence
           from ApidbTuning.IsolateAttributes i
           LEFT OUTER JOIN ApidbTuning.IsolateSequence s
           ON i.source_id = s.source_id
           </sql>
      </sqlQuery>

    </querySet>
</wdkModel>
