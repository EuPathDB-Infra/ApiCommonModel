#!/usr/bin/env python

import sys
sys.path.insert(0, "/Users/crisl-adm/Tools/vagrant-wij42/scratch/ud_dashboard/lib/python")
import argparse
from user_dataset_dashboard.dashboard import Dashboard


def main():

    dashboard = Dashboard()

    parser = argparse.ArgumentParser(description='User Dataset Dignostics')
    subparsers = parser.add_subparsers(help='diagnostic subcommand')

    parser_workspace_report = subparsers.add_parser('workspace_report', help='report on the iRODS workspace')
    parser_workspace_report.set_defaults(func=dashboard.workspace_report)

    parser_user_report = subparsers.add_parser('user_report', help='report on a user identified by his/her email address')
    parser_user_report.add_argument('user_email', type=str, help='email address user uses to log into wdk')
    parser_user_report.set_defaults(func=dashboard.user_report)

    parser_dataset_report = subparsers.add_parser('dataset_report', help='report on a user dataset identified by its id')
    parser_dataset_report.add_argument('dataset_id', type=str, help='irods id for irods user dataset collection')
    parser_dataset_report.set_defaults(func=dashboard.dataset_report)

    args = parser.parse_args()
    args.func(args)


if __name__ == "__main__":
    sys.exit(main())